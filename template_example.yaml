---
# Source: qualys-tc/charts/admissionController/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: admission-controller-qualys-sa
  labels:
    app: qualys-tc
    chart: "admissionController-1.0.4"
    release: "qualys-tc"
    heritage: "Helm"
---
# Source: qualys-tc/charts/clusterSensor/templates/clustersensor-serviceaccount.yaml
# Service Account
apiVersion: v1
kind: ServiceAccount
metadata:
  name: qualys-clustersensor-sa
  namespace: qualys
---
# Source: qualys-tc/charts/qcsSensor/templates/cssensor-serviceaccount.yaml
# Service Account

apiVersion: v1
kind: ServiceAccount
metadata:
  name: qualys-service-account
  namespace: qualys
---
# Source: qualys-tc/charts/runtimeSensor/templates/runtime-sensor-serviceaccount.yaml
# Service Account
apiVersion: v1
kind: ServiceAccount
metadata:
  name: qualys-runtimesensor-sa
  namespace: qualys
---
# Source: qualys-tc/charts/admissionController/templates/config-map.yaml
kind: ConfigMap
apiVersion: v1
metadata:
  name: admission-controller-config
  namespace: qualys
data:
  config.yaml: |
    ---
    clusterMetadata:
        cloudProvider: "SELF_MANAGED_K8S"
        clusterName: "virttest"

    qualysGatewayUrl: https://gateway.qg1.apps.qualys.co.uk
    customerUuid: dc965ac5-375a-dd6a-834d-788f666fad44
    activationId: f70e5b6a-0cb3-4a24-9994-843c5d40f028
    logging: 
        file:
          directory: /usr/local/qualys/admission-controller/data/logs
          name: admission-controller.log
          rotation:
            compress: true
            enabled: true
            maxAge: 180
            maxBackups: 4
            maxSize: 100
        level: info

    server:
      version: "1.1.0-17"
      port: 8443
      certFilePath: /etc/certs/tls.crt
      certKeyPath: /etc/certs/tls.key

    policy:
      failurePolicy: Ignore

    syncInterval: 15
    platformSyncInterval: 5

    dataRetention:
      inDays: 30
      scheduleInMillis: 86400000

    httpConfig:
      inbound:
        debug: false
      outbound:
        skipVerifyTLS: false
        certPath: 
        proxy: 
    enforcementAction: Audit
    imageDigestCacheTTL: 1m
---
# Source: qualys-tc/charts/admissionController/templates/config-map.yaml
kind: ConfigMap
apiVersion: v1
metadata:
  name: qualys-registry-config
  namespace: qualys
data:
  registry-config.yaml: |
    ---
---
# Source: qualys-tc/charts/runtimeSensor/templates/runtime-sensor-customcrd.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  creationTimestamp: null
  name: policies.qualys.com
spec:
  group: qualys.com
  names:
    kind: FimPolicy
    plural: policies
    shortNames:
    - fim
    singular: policy
  scope: Cluster
  versions:
  - name: v1
    schema:
      openAPIV3Schema:
        properties:
          spec:
            description: "\n\t\t------ BEGIN README ---------------------\n\t\tFollowing
              is the process of creating, applying, and deleting File Integrity Monitoring
              (FIM) policies. \n\t\tSample policies (modify as per the requirement
              and apply) - \n\t\t1) Monitor file open action\n\t\t-----------------------------------------\n\t\t\tapiVersion:
              qualys.com/v1\n\t\t\tkind: FimPolicy\n\t\t\tmetadata:\n\t\t\t\tname:
              monitor-file-open\n\t\t\tspec:\n\t\t\t\tbase-policy: \"file-open\"\n\t\t\t\taction:
              \"audit\"\n\t\t\t\tmonitor-paths:\n\t\t\t\t\t- \"/var/log/\"\n\t\t\t\t\t-
              \"/etc/nginx/\"\n\t\t-----------------------------------------\n\t\t2)
              Monitor file read action\n\t\t-----------------------------------------\n\t\t\tapiVersion:
              qualys.com/v1\n\t\t\tkind: FimPolicy\n\t\t\tmetadata:\n\t\t\t\tname:
              monitor-file-read\n\t\t\tspec:\n\t\t\t\tbase-policy: \"file-read\"\n\t\t\t\taction:
              \"audit\"\n\t\t\t\tmonitor-paths:\n\t\t\t\t\t- \"/etc/passwd\"\n\t\t-----------------------------------------\n\t\t3)
              Monitor file write action\n\t\t-----------------------------------------\n\t\t\tapiVersion:
              qualys.com/v1\n\t\t\tkind: FimPolicy\n\t\t\tmetadata:\n\t\t\t\tname:
              monitor-file-write\n\t\t\tspec:\n\t\t\t\tbase-policy: \"file-write\"\n\t\t\t\taction:
              \"audit\"\n\t\t\t\tmonitor-paths:\n\t\t\t\t\t- \"/etc/passwd\"\n\t\t-----------------------------------------\n\t\t4)
              Monitor file write with diff action\n\t\t-----------------------------------------\n\t\t\tapiVersion:
              qualys.com/v1\n\t\t\tkind: FimPolicy\n\t\t\tmetadata:\n\t\t\t\tname:
              monitor-file-write-diff\n\t\t\tspec:\n\t\t\t\tbase-policy: \"file-write-diff\"\n\t\t\t\taction:
              \"audit\"\n\t\t\t\tmonitor-paths:\n\t\t\t\t\t- \"/etc/\"\n\t\t-----------------------------------------\n\t\t5)
              Monitor file rename action\n\t\t-----------------------------------------\n\t\t\tapiVersion:
              qualys.com/v1\n\t\t\tkind: FimPolicy\n\t\t\tmetadata:\n\t\t\t\tname:
              monitor-file-rename\n\t\t\tspec:\n\t\t\t\tbase-policy: \"file-rename\"\n\t\t\t\taction:
              \"audit\"\n\t\t\t\tmonitor-paths:\n\t\t\t\t\t- \"/etc/\"\n\t\t-----------------------------------------\n\t\t6)
              Monitor file delete action\n\t\t-----------------------------------------\n\t\t\tapiVersion:
              qualys.com/v1\n\t\t\tkind: FimPolicy\n\t\t\tmetadata:\n\t\t\t\tname:
              monitor-file-delete\n\t\t\tspec:\n\t\t\t\tbase-policy: \"file-delete\"\n\t\t\t\taction:
              \"audit\"\n\t\t\t\tmonitor-paths:\n\t\t\t\t\t- \"/etc/\"\n\t\t-----------------------------------------\n\t\tApply
              policy -\n\t\t\tsh# kubectl apply -f <filename>\n\t\t\tEx: kubectl apply
              -f fim-policy-file-open.yaml\n\t\tView active policies -\n\t\t\tsh#
              kubectl get policies.qualys.com\n\t\tView Policies details -\n\t\t\tsh#
              kubectl describe policies.qualys.com <policy-name>\n\t\t\tEx: kubectl
              describe policies.qualys.com fim-policy-open\n\t\tDelete policy -\n\t\t\tsh#
              kubectl delete policies.qualys.com <policy-name>\n\t\t\tEx: kubectl
              delete policies.qualys.com fim-policy-open\n\t\t------END README -------------------------"
            properties:
              action:
                enum:
                - audit
                type: string
              base-policy:
                enum:
                - file-open
                - file-read
                - file-write
                - file-write-diff
                - file-rename
                - file-delete
                type: string
              monitor-paths:
                items:
                  maxLength: 64
                  minLength: 2
                  pattern: ^/.*
                  type: string
                minItems: 1
                type: array
            required:
            - base-policy
            - action
            - monitor-paths
            type: object
        type: object
    served: true
    storage: true
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: null
  storedVersions: null
---
# Source: qualys-tc/charts/runtimeSensor/templates/runtime-sensor-tracingpolicies.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.13.0
  creationTimestamp: null
  name: tracingpolicies.cilium.io
spec:
  group: cilium.io
  names:
    kind: TracingPolicy
    listKind: TracingPolicyList
    plural: tracingpolicies
    singular: tracingpolicy
  scope: Cluster
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: Tracing policy specification.
            properties:
              killers:
                description: A killer spec.
                items:
                  properties:
                    calls:
                      description: Calls where killer is executed in
                      items:
                        type: string
                      type: array
                  required:
                  - calls
                  type: object
                type: array
              kprobes:
                description: A list of kprobe specs.
                items:
                  properties:
                    args:
                      description: A list of function arguments to include in the
                        trace output.
                      items:
                        properties:
                          index:
                            description: Position of the argument.
                            format: int32
                            minimum: 0
                            type: integer
                          label:
                            description: Label to output in the JSON
                            type: string
                          maxData:
                            default: false
                            description: Read maximum possible data (currently 327360).
                              This field is only used for char_buff data. When this
                              value is false (default), the bpf program will fetch
                              at most 4096 bytes. In later kernels (>=5.4) tetragon
                              supports fetching up to 327360 bytes if this flag is
                              turned on
                            type: boolean
                          returnCopy:
                            default: false
                            description: This field is used only for char_buf and
                              char_iovec types. It indicates that this argument should
                              be read later (when the kretprobe for the symbol is
                              triggered) because it might not be populated when the
                              kprobe is triggered at the entrance of the function.
                              For example, a buffer supplied to read(2) won't have
                              content until kretprobe is triggered.
                            type: boolean
                          sizeArgIndex:
                            description: Specifies the position of the corresponding
                              size argument for this argument. This field is used
                              only for char_buf and char_iovec types.
                            format: int32
                            minimum: 0
                            type: integer
                          type:
                            default: auto
                            description: Argument type.
                            enum:
                            - auto
                            - int
                            - int8
                            - uint8
                            - int16
                            - uint16
                            - uint32
                            - int32
                            - uint64
                            - int64
                            - char_buf
                            - char_iovec
                            - size_t
                            - skb
                            - sock
                            - string
                            - fd
                            - file
                            - filename
                            - path
                            - nop
                            - bpf_attr
                            - perf_event
                            - bpf_map
                            - user_namespace
                            - capability
                            - kiocb
                            - iov_iter
                            - cred
                            - load_info
                            - module
                            - syscall64
                            - kernel_cap_t
                            - cap_inheritable
                            - cap_permitted
                            - cap_effective
                            type: string
                        required:
                        - index
                        - type
                        type: object
                      type: array
                    call:
                      description: Name of the function to apply the kprobe spec to.
                      type: string
                    message:
                      description: A short message of 256 characters max that will
                        be included in the event output to inform users what is going
                        on.
                      type: string
                    return:
                      default: false
                      description: Indicates whether to collect return value of the
                        traced function.
                      type: boolean
                    returnArg:
                      description: A return argument to include in the trace output.
                      properties:
                        index:
                          description: Position of the argument.
                          format: int32
                          minimum: 0
                          type: integer
                        label:
                          description: Label to output in the JSON
                          type: string
                        maxData:
                          default: false
                          description: Read maximum possible data (currently 327360).
                            This field is only used for char_buff data. When this
                            value is false (default), the bpf program will fetch at
                            most 4096 bytes. In later kernels (>=5.4) tetragon supports
                            fetching up to 327360 bytes if this flag is turned on
                          type: boolean
                        returnCopy:
                          default: false
                          description: This field is used only for char_buf and char_iovec
                            types. It indicates that this argument should be read
                            later (when the kretprobe for the symbol is triggered)
                            because it might not be populated when the kprobe is triggered
                            at the entrance of the function. For example, a buffer
                            supplied to read(2) won't have content until kretprobe
                            is triggered.
                          type: boolean
                        sizeArgIndex:
                          description: Specifies the position of the corresponding
                            size argument for this argument. This field is used only
                            for char_buf and char_iovec types.
                          format: int32
                          minimum: 0
                          type: integer
                        type:
                          default: auto
                          description: Argument type.
                          enum:
                          - auto
                          - int
                          - int8
                          - uint8
                          - int16
                          - uint16
                          - uint32
                          - int32
                          - uint64
                          - int64
                          - char_buf
                          - char_iovec
                          - size_t
                          - skb
                          - sock
                          - string
                          - fd
                          - file
                          - filename
                          - path
                          - nop
                          - bpf_attr
                          - perf_event
                          - bpf_map
                          - user_namespace
                          - capability
                          - kiocb
                          - iov_iter
                          - cred
                          - load_info
                          - module
                          - syscall64
                          - kernel_cap_t
                          - cap_inheritable
                          - cap_permitted
                          - cap_effective
                          type: string
                      required:
                      - index
                      - type
                      type: object
                    returnArgAction:
                      description: 'An action to perform on the return argument. Available
                        actions are: Post;TrackSock;UntrackSock'
                      type: string
                    selectors:
                      description: Selectors to apply before producing trace output.
                        Selectors are ORed.
                      items:
                        description: KProbeSelector selects function calls for kprobe
                          based on PIDs and function arguments. The results of MatchPIDs
                          and MatchArgs are ANDed.
                        properties:
                          matchActions:
                            description: A list of actions to execute when this selector
                              matches
                            items:
                              properties:
                                action:
                                  description: Action to execute.
                                  enum:
                                  - Post
                                  - FollowFD
                                  - UnfollowFD
                                  - Sigkill
                                  - CopyFD
                                  - Override
                                  - GetUrl
                                  - DnsLookup
                                  - NoPost
                                  - Signal
                                  - TrackSock
                                  - UntrackSock
                                  - NotifyKiller
                                  type: string
                                argError:
                                  description: error value for override action
                                  format: int32
                                  type: integer
                                argFd:
                                  description: An arg index for the fd for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argFqdn:
                                  description: A FQDN to lookup for the dnsLookup
                                    action
                                  type: string
                                argName:
                                  description: An arg index for the filename for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argSig:
                                  description: A signal number for signal action
                                  format: int32
                                  type: integer
                                argSock:
                                  description: An arg index for the sock for trackSock
                                    and untrackSock actions
                                  format: int32
                                  type: integer
                                argUrl:
                                  description: A URL for the getUrl action
                                  type: string
                                rateLimit:
                                  description: A time period within which repeated
                                    messages will not be posted. Can be specified
                                    in seconds (default or with 's' suffix), minutes
                                    ('m' suffix) or hours ('h' suffix). Only valid
                                    with the post action.
                                  type: string
                                rateLimitScope:
                                  description: The scope of the provided rate limit
                                    argument. Can be "thread" (default), "process"
                                    (all threads for the same process), or "global".
                                    If "thread" is selected then rate limiting applies
                                    per thread; if "process" is selected then rate
                                    limiting applies per process; if "global" is selected
                                    then rate limiting applies regardless of which
                                    process or thread caused the action. Only valid
                                    with the post action and with a rateLimit specified.
                                  type: string
                                stackTrace:
                                  description: Enable stack trace export. Only valid
                                    with the post action.
                                  type: boolean
                              required:
                              - action
                              type: object
                            type: array
                          matchArgs:
                            description: A list of argument filters. MatchArgs are
                              ANDed.
                            items:
                              properties:
                                index:
                                  description: Position of the argument to apply fhe
                                    filter to.
                                  format: int32
                                  minimum: 0
                                  type: integer
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - Equal
                                  - NotEqual
                                  - Prefix
                                  - NotPrefix
                                  - Postfix
                                  - NotPostfix
                                  - GreaterThan
                                  - LessThan
                                  - GT
                                  - LT
                                  - Mask
                                  - SPort
                                  - NotSPort
                                  - SPortPriv
                                  - NotSportPriv
                                  - DPort
                                  - NotDPort
                                  - DPortPriv
                                  - NotDPortPriv
                                  - SAddr
                                  - NotSAddr
                                  - DAddr
                                  - NotDAddr
                                  - Protocol
                                  - Family
                                  - State
                                  - InMap
                                  - NotInMap
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - index
                              - operator
                              type: object
                            type: array
                          matchBinaries:
                            description: A list of binary exec name filters.
                            items:
                              properties:
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - In
                                  - NotIn
                                  - Prefix
                                  - NotPrefix
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchCapabilities:
                            description: A list of capabilities and IDs
                            items:
                              properties:
                                isNamespaceCapability:
                                  default: false
                                  description: Indicates whether these caps are namespace
                                    caps.
                                  type: boolean
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                type:
                                  default: Effective
                                  description: Type of capabilities
                                  enum:
                                  - Effective
                                  - Inheritable
                                  - Permitted
                                  type: string
                                values:
                                  description: Capabilities to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchCapabilityChanges:
                            description: IDs for capabilities changes
                            items:
                              properties:
                                isNamespaceCapability:
                                  default: false
                                  description: Indicates whether these caps are namespace
                                    caps.
                                  type: boolean
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                type:
                                  default: Effective
                                  description: Type of capabilities
                                  enum:
                                  - Effective
                                  - Inheritable
                                  - Permitted
                                  type: string
                                values:
                                  description: Capabilities to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchNamespaceChanges:
                            description: IDs for namespace changes
                            items:
                              properties:
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Namespace types (e.g., Mnt, Pid) to
                                    match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchNamespaces:
                            description: A list of namespaces and IDs
                            items:
                              properties:
                                namespace:
                                  description: Namespace selector name.
                                  enum:
                                  - Uts
                                  - Ipc
                                  - Mnt
                                  - Pid
                                  - PidForChildren
                                  - Net
                                  - Time
                                  - TimeForChildren
                                  - Cgroup
                                  - User
                                  type: string
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Namespace IDs (or host_ns for host
                                    namespace) of namespaces to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - namespace
                              - operator
                              - values
                              type: object
                            type: array
                          matchPIDs:
                            description: A list of process ID filters. MatchPIDs are
                              ANDed.
                            items:
                              properties:
                                followForks:
                                  default: false
                                  description: Matches any descendant processes of
                                    the matching PIDs.
                                  type: boolean
                                isNamespacePID:
                                  default: false
                                  description: Indicates whether PIDs are namespace
                                    PIDs.
                                  type: boolean
                                operator:
                                  description: PID selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Process IDs to match.
                                  items:
                                    format: int32
                                    type: integer
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchReturnActions:
                            description: A list of actions to execute when MatchReturnArgs
                              selector matches
                            items:
                              properties:
                                action:
                                  description: Action to execute.
                                  enum:
                                  - Post
                                  - FollowFD
                                  - UnfollowFD
                                  - Sigkill
                                  - CopyFD
                                  - Override
                                  - GetUrl
                                  - DnsLookup
                                  - NoPost
                                  - Signal
                                  - TrackSock
                                  - UntrackSock
                                  - NotifyKiller
                                  type: string
                                argError:
                                  description: error value for override action
                                  format: int32
                                  type: integer
                                argFd:
                                  description: An arg index for the fd for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argFqdn:
                                  description: A FQDN to lookup for the dnsLookup
                                    action
                                  type: string
                                argName:
                                  description: An arg index for the filename for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argSig:
                                  description: A signal number for signal action
                                  format: int32
                                  type: integer
                                argSock:
                                  description: An arg index for the sock for trackSock
                                    and untrackSock actions
                                  format: int32
                                  type: integer
                                argUrl:
                                  description: A URL for the getUrl action
                                  type: string
                                rateLimit:
                                  description: A time period within which repeated
                                    messages will not be posted. Can be specified
                                    in seconds (default or with 's' suffix), minutes
                                    ('m' suffix) or hours ('h' suffix). Only valid
                                    with the post action.
                                  type: string
                                rateLimitScope:
                                  description: The scope of the provided rate limit
                                    argument. Can be "thread" (default), "process"
                                    (all threads for the same process), or "global".
                                    If "thread" is selected then rate limiting applies
                                    per thread; if "process" is selected then rate
                                    limiting applies per process; if "global" is selected
                                    then rate limiting applies regardless of which
                                    process or thread caused the action. Only valid
                                    with the post action and with a rateLimit specified.
                                  type: string
                                stackTrace:
                                  description: Enable stack trace export. Only valid
                                    with the post action.
                                  type: boolean
                              required:
                              - action
                              type: object
                            type: array
                          matchReturnArgs:
                            description: A list of argument filters. MatchArgs are
                              ANDed.
                            items:
                              properties:
                                index:
                                  description: Position of the argument to apply fhe
                                    filter to.
                                  format: int32
                                  minimum: 0
                                  type: integer
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - Equal
                                  - NotEqual
                                  - Prefix
                                  - NotPrefix
                                  - Postfix
                                  - NotPostfix
                                  - GreaterThan
                                  - LessThan
                                  - GT
                                  - LT
                                  - Mask
                                  - SPort
                                  - NotSPort
                                  - SPortPriv
                                  - NotSportPriv
                                  - DPort
                                  - NotDPort
                                  - DPortPriv
                                  - NotDPortPriv
                                  - SAddr
                                  - NotSAddr
                                  - DAddr
                                  - NotDAddr
                                  - Protocol
                                  - Family
                                  - State
                                  - InMap
                                  - NotInMap
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - index
                              - operator
                              type: object
                            type: array
                        type: object
                      type: array
                    syscall:
                      default: true
                      description: Indicates whether the traced function is a syscall.
                      type: boolean
                  required:
                  - call
                  type: object
                type: array
              lists:
                description: A list of list specs.
                items:
                  properties:
                    name:
                      description: Name of the list
                      type: string
                    pattern:
                      description: Pattern for 'generated' lists.
                      type: string
                    type:
                      description: Indicates the type of the list values.
                      enum:
                      - syscalls
                      - generated_syscalls
                      - generated_ftrace
                      type: string
                    validated:
                      description: List was validated
                      type: boolean
                    values:
                      description: Values of the list
                      items:
                        type: string
                      type: array
                  required:
                  - name
                  type: object
                type: array
              loader:
                description: Enable loader events
                type: boolean
              options:
                description: A list of overloaded options
                items:
                  properties:
                    name:
                      description: Name of the option
                      type: string
                    value:
                      description: Value of the option
                      type: string
                  required:
                  - name
                  type: object
                type: array
              podSelector:
                description: PodSelector selects pods that this policy applies to
                properties:
                  matchExpressions:
                    description: matchExpressions is a list of label selector requirements.
                      The requirements are ANDed.
                    items:
                      description: A label selector requirement is a selector that
                        contains values, a key, and an operator that relates the key
                        and values.
                      properties:
                        key:
                          description: key is the label key that the selector applies
                            to.
                          type: string
                        operator:
                          description: operator represents a key's relationship to
                            a set of values. Valid operators are In, NotIn, Exists
                            and DoesNotExist.
                          enum:
                          - In
                          - NotIn
                          - Exists
                          - DoesNotExist
                          type: string
                        values:
                          description: values is an array of string values. If the
                            operator is In or NotIn, the values array must be non-empty.
                            If the operator is Exists or DoesNotExist, the values
                            array must be empty. This array is replaced during a strategic
                            merge patch.
                          items:
                            type: string
                          type: array
                      required:
                      - key
                      - operator
                      type: object
                    type: array
                  matchLabels:
                    additionalProperties:
                      description: MatchLabelsValue represents the value from the
                        MatchLabels {key,value} pair.
                      maxLength: 63
                      pattern: ^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$
                      type: string
                    description: matchLabels is a map of {key,value} pairs. A single
                      {key,value} in the matchLabels map is equivalent to an element
                      of matchExpressions, whose key field is "key", the operator
                      is "In", and the values array contains only "value". The requirements
                      are ANDed.
                    type: object
                type: object
              tracepoints:
                description: A list of tracepoint specs.
                items:
                  properties:
                    args:
                      description: A list of function arguments to include in the
                        trace output.
                      items:
                        properties:
                          index:
                            description: Position of the argument.
                            format: int32
                            minimum: 0
                            type: integer
                          label:
                            description: Label to output in the JSON
                            type: string
                          maxData:
                            default: false
                            description: Read maximum possible data (currently 327360).
                              This field is only used for char_buff data. When this
                              value is false (default), the bpf program will fetch
                              at most 4096 bytes. In later kernels (>=5.4) tetragon
                              supports fetching up to 327360 bytes if this flag is
                              turned on
                            type: boolean
                          returnCopy:
                            default: false
                            description: This field is used only for char_buf and
                              char_iovec types. It indicates that this argument should
                              be read later (when the kretprobe for the symbol is
                              triggered) because it might not be populated when the
                              kprobe is triggered at the entrance of the function.
                              For example, a buffer supplied to read(2) won't have
                              content until kretprobe is triggered.
                            type: boolean
                          sizeArgIndex:
                            description: Specifies the position of the corresponding
                              size argument for this argument. This field is used
                              only for char_buf and char_iovec types.
                            format: int32
                            minimum: 0
                            type: integer
                          type:
                            default: auto
                            description: Argument type.
                            enum:
                            - auto
                            - int
                            - int8
                            - uint8
                            - int16
                            - uint16
                            - uint32
                            - int32
                            - uint64
                            - int64
                            - char_buf
                            - char_iovec
                            - size_t
                            - skb
                            - sock
                            - string
                            - fd
                            - file
                            - filename
                            - path
                            - nop
                            - bpf_attr
                            - perf_event
                            - bpf_map
                            - user_namespace
                            - capability
                            - kiocb
                            - iov_iter
                            - cred
                            - load_info
                            - module
                            - syscall64
                            - kernel_cap_t
                            - cap_inheritable
                            - cap_permitted
                            - cap_effective
                            type: string
                        required:
                        - index
                        - type
                        type: object
                      type: array
                    event:
                      description: Tracepoint event
                      type: string
                    message:
                      description: A short message of 256 characters max that will
                        be included in the event output to inform users what is going
                        on.
                      type: string
                    selectors:
                      description: Selectors to apply before producing trace output.
                        Selectors are ORed.
                      items:
                        description: KProbeSelector selects function calls for kprobe
                          based on PIDs and function arguments. The results of MatchPIDs
                          and MatchArgs are ANDed.
                        properties:
                          matchActions:
                            description: A list of actions to execute when this selector
                              matches
                            items:
                              properties:
                                action:
                                  description: Action to execute.
                                  enum:
                                  - Post
                                  - FollowFD
                                  - UnfollowFD
                                  - Sigkill
                                  - CopyFD
                                  - Override
                                  - GetUrl
                                  - DnsLookup
                                  - NoPost
                                  - Signal
                                  - TrackSock
                                  - UntrackSock
                                  - NotifyKiller
                                  type: string
                                argError:
                                  description: error value for override action
                                  format: int32
                                  type: integer
                                argFd:
                                  description: An arg index for the fd for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argFqdn:
                                  description: A FQDN to lookup for the dnsLookup
                                    action
                                  type: string
                                argName:
                                  description: An arg index for the filename for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argSig:
                                  description: A signal number for signal action
                                  format: int32
                                  type: integer
                                argSock:
                                  description: An arg index for the sock for trackSock
                                    and untrackSock actions
                                  format: int32
                                  type: integer
                                argUrl:
                                  description: A URL for the getUrl action
                                  type: string
                                rateLimit:
                                  description: A time period within which repeated
                                    messages will not be posted. Can be specified
                                    in seconds (default or with 's' suffix), minutes
                                    ('m' suffix) or hours ('h' suffix). Only valid
                                    with the post action.
                                  type: string
                                rateLimitScope:
                                  description: The scope of the provided rate limit
                                    argument. Can be "thread" (default), "process"
                                    (all threads for the same process), or "global".
                                    If "thread" is selected then rate limiting applies
                                    per thread; if "process" is selected then rate
                                    limiting applies per process; if "global" is selected
                                    then rate limiting applies regardless of which
                                    process or thread caused the action. Only valid
                                    with the post action and with a rateLimit specified.
                                  type: string
                                stackTrace:
                                  description: Enable stack trace export. Only valid
                                    with the post action.
                                  type: boolean
                              required:
                              - action
                              type: object
                            type: array
                          matchArgs:
                            description: A list of argument filters. MatchArgs are
                              ANDed.
                            items:
                              properties:
                                index:
                                  description: Position of the argument to apply fhe
                                    filter to.
                                  format: int32
                                  minimum: 0
                                  type: integer
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - Equal
                                  - NotEqual
                                  - Prefix
                                  - NotPrefix
                                  - Postfix
                                  - NotPostfix
                                  - GreaterThan
                                  - LessThan
                                  - GT
                                  - LT
                                  - Mask
                                  - SPort
                                  - NotSPort
                                  - SPortPriv
                                  - NotSportPriv
                                  - DPort
                                  - NotDPort
                                  - DPortPriv
                                  - NotDPortPriv
                                  - SAddr
                                  - NotSAddr
                                  - DAddr
                                  - NotDAddr
                                  - Protocol
                                  - Family
                                  - State
                                  - InMap
                                  - NotInMap
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - index
                              - operator
                              type: object
                            type: array
                          matchBinaries:
                            description: A list of binary exec name filters.
                            items:
                              properties:
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - In
                                  - NotIn
                                  - Prefix
                                  - NotPrefix
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchCapabilities:
                            description: A list of capabilities and IDs
                            items:
                              properties:
                                isNamespaceCapability:
                                  default: false
                                  description: Indicates whether these caps are namespace
                                    caps.
                                  type: boolean
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                type:
                                  default: Effective
                                  description: Type of capabilities
                                  enum:
                                  - Effective
                                  - Inheritable
                                  - Permitted
                                  type: string
                                values:
                                  description: Capabilities to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchCapabilityChanges:
                            description: IDs for capabilities changes
                            items:
                              properties:
                                isNamespaceCapability:
                                  default: false
                                  description: Indicates whether these caps are namespace
                                    caps.
                                  type: boolean
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                type:
                                  default: Effective
                                  description: Type of capabilities
                                  enum:
                                  - Effective
                                  - Inheritable
                                  - Permitted
                                  type: string
                                values:
                                  description: Capabilities to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchNamespaceChanges:
                            description: IDs for namespace changes
                            items:
                              properties:
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Namespace types (e.g., Mnt, Pid) to
                                    match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchNamespaces:
                            description: A list of namespaces and IDs
                            items:
                              properties:
                                namespace:
                                  description: Namespace selector name.
                                  enum:
                                  - Uts
                                  - Ipc
                                  - Mnt
                                  - Pid
                                  - PidForChildren
                                  - Net
                                  - Time
                                  - TimeForChildren
                                  - Cgroup
                                  - User
                                  type: string
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Namespace IDs (or host_ns for host
                                    namespace) of namespaces to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - namespace
                              - operator
                              - values
                              type: object
                            type: array
                          matchPIDs:
                            description: A list of process ID filters. MatchPIDs are
                              ANDed.
                            items:
                              properties:
                                followForks:
                                  default: false
                                  description: Matches any descendant processes of
                                    the matching PIDs.
                                  type: boolean
                                isNamespacePID:
                                  default: false
                                  description: Indicates whether PIDs are namespace
                                    PIDs.
                                  type: boolean
                                operator:
                                  description: PID selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Process IDs to match.
                                  items:
                                    format: int32
                                    type: integer
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchReturnActions:
                            description: A list of actions to execute when MatchReturnArgs
                              selector matches
                            items:
                              properties:
                                action:
                                  description: Action to execute.
                                  enum:
                                  - Post
                                  - FollowFD
                                  - UnfollowFD
                                  - Sigkill
                                  - CopyFD
                                  - Override
                                  - GetUrl
                                  - DnsLookup
                                  - NoPost
                                  - Signal
                                  - TrackSock
                                  - UntrackSock
                                  - NotifyKiller
                                  type: string
                                argError:
                                  description: error value for override action
                                  format: int32
                                  type: integer
                                argFd:
                                  description: An arg index for the fd for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argFqdn:
                                  description: A FQDN to lookup for the dnsLookup
                                    action
                                  type: string
                                argName:
                                  description: An arg index for the filename for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argSig:
                                  description: A signal number for signal action
                                  format: int32
                                  type: integer
                                argSock:
                                  description: An arg index for the sock for trackSock
                                    and untrackSock actions
                                  format: int32
                                  type: integer
                                argUrl:
                                  description: A URL for the getUrl action
                                  type: string
                                rateLimit:
                                  description: A time period within which repeated
                                    messages will not be posted. Can be specified
                                    in seconds (default or with 's' suffix), minutes
                                    ('m' suffix) or hours ('h' suffix). Only valid
                                    with the post action.
                                  type: string
                                rateLimitScope:
                                  description: The scope of the provided rate limit
                                    argument. Can be "thread" (default), "process"
                                    (all threads for the same process), or "global".
                                    If "thread" is selected then rate limiting applies
                                    per thread; if "process" is selected then rate
                                    limiting applies per process; if "global" is selected
                                    then rate limiting applies regardless of which
                                    process or thread caused the action. Only valid
                                    with the post action and with a rateLimit specified.
                                  type: string
                                stackTrace:
                                  description: Enable stack trace export. Only valid
                                    with the post action.
                                  type: boolean
                              required:
                              - action
                              type: object
                            type: array
                          matchReturnArgs:
                            description: A list of argument filters. MatchArgs are
                              ANDed.
                            items:
                              properties:
                                index:
                                  description: Position of the argument to apply fhe
                                    filter to.
                                  format: int32
                                  minimum: 0
                                  type: integer
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - Equal
                                  - NotEqual
                                  - Prefix
                                  - NotPrefix
                                  - Postfix
                                  - NotPostfix
                                  - GreaterThan
                                  - LessThan
                                  - GT
                                  - LT
                                  - Mask
                                  - SPort
                                  - NotSPort
                                  - SPortPriv
                                  - NotSportPriv
                                  - DPort
                                  - NotDPort
                                  - DPortPriv
                                  - NotDPortPriv
                                  - SAddr
                                  - NotSAddr
                                  - DAddr
                                  - NotDAddr
                                  - Protocol
                                  - Family
                                  - State
                                  - InMap
                                  - NotInMap
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - index
                              - operator
                              type: object
                            type: array
                        type: object
                      type: array
                    subsystem:
                      description: Tracepoint subsystem
                      type: string
                  required:
                  - event
                  - subsystem
                  type: object
                type: array
              uprobes:
                description: A list of uprobe specs.
                items:
                  properties:
                    args:
                      description: A list of function arguments to include in the
                        trace output.
                      items:
                        properties:
                          index:
                            description: Position of the argument.
                            format: int32
                            minimum: 0
                            type: integer
                          label:
                            description: Label to output in the JSON
                            type: string
                          maxData:
                            default: false
                            description: Read maximum possible data (currently 327360).
                              This field is only used for char_buff data. When this
                              value is false (default), the bpf program will fetch
                              at most 4096 bytes. In later kernels (>=5.4) tetragon
                              supports fetching up to 327360 bytes if this flag is
                              turned on
                            type: boolean
                          returnCopy:
                            default: false
                            description: This field is used only for char_buf and
                              char_iovec types. It indicates that this argument should
                              be read later (when the kretprobe for the symbol is
                              triggered) because it might not be populated when the
                              kprobe is triggered at the entrance of the function.
                              For example, a buffer supplied to read(2) won't have
                              content until kretprobe is triggered.
                            type: boolean
                          sizeArgIndex:
                            description: Specifies the position of the corresponding
                              size argument for this argument. This field is used
                              only for char_buf and char_iovec types.
                            format: int32
                            minimum: 0
                            type: integer
                          type:
                            default: auto
                            description: Argument type.
                            enum:
                            - auto
                            - int
                            - int8
                            - uint8
                            - int16
                            - uint16
                            - uint32
                            - int32
                            - uint64
                            - int64
                            - char_buf
                            - char_iovec
                            - size_t
                            - skb
                            - sock
                            - string
                            - fd
                            - file
                            - filename
                            - path
                            - nop
                            - bpf_attr
                            - perf_event
                            - bpf_map
                            - user_namespace
                            - capability
                            - kiocb
                            - iov_iter
                            - cred
                            - load_info
                            - module
                            - syscall64
                            - kernel_cap_t
                            - cap_inheritable
                            - cap_permitted
                            - cap_effective
                            type: string
                        required:
                        - index
                        - type
                        type: object
                      type: array
                    message:
                      description: A short message of 256 characters max that will
                        be included in the event output to inform users what is going
                        on.
                      type: string
                    path:
                      description: Name of the traced binary
                      type: string
                    selectors:
                      description: Selectors to apply before producing trace output.
                        Selectors are ORed.
                      items:
                        description: KProbeSelector selects function calls for kprobe
                          based on PIDs and function arguments. The results of MatchPIDs
                          and MatchArgs are ANDed.
                        properties:
                          matchActions:
                            description: A list of actions to execute when this selector
                              matches
                            items:
                              properties:
                                action:
                                  description: Action to execute.
                                  enum:
                                  - Post
                                  - FollowFD
                                  - UnfollowFD
                                  - Sigkill
                                  - CopyFD
                                  - Override
                                  - GetUrl
                                  - DnsLookup
                                  - NoPost
                                  - Signal
                                  - TrackSock
                                  - UntrackSock
                                  - NotifyKiller
                                  type: string
                                argError:
                                  description: error value for override action
                                  format: int32
                                  type: integer
                                argFd:
                                  description: An arg index for the fd for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argFqdn:
                                  description: A FQDN to lookup for the dnsLookup
                                    action
                                  type: string
                                argName:
                                  description: An arg index for the filename for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argSig:
                                  description: A signal number for signal action
                                  format: int32
                                  type: integer
                                argSock:
                                  description: An arg index for the sock for trackSock
                                    and untrackSock actions
                                  format: int32
                                  type: integer
                                argUrl:
                                  description: A URL for the getUrl action
                                  type: string
                                rateLimit:
                                  description: A time period within which repeated
                                    messages will not be posted. Can be specified
                                    in seconds (default or with 's' suffix), minutes
                                    ('m' suffix) or hours ('h' suffix). Only valid
                                    with the post action.
                                  type: string
                                rateLimitScope:
                                  description: The scope of the provided rate limit
                                    argument. Can be "thread" (default), "process"
                                    (all threads for the same process), or "global".
                                    If "thread" is selected then rate limiting applies
                                    per thread; if "process" is selected then rate
                                    limiting applies per process; if "global" is selected
                                    then rate limiting applies regardless of which
                                    process or thread caused the action. Only valid
                                    with the post action and with a rateLimit specified.
                                  type: string
                                stackTrace:
                                  description: Enable stack trace export. Only valid
                                    with the post action.
                                  type: boolean
                              required:
                              - action
                              type: object
                            type: array
                          matchArgs:
                            description: A list of argument filters. MatchArgs are
                              ANDed.
                            items:
                              properties:
                                index:
                                  description: Position of the argument to apply fhe
                                    filter to.
                                  format: int32
                                  minimum: 0
                                  type: integer
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - Equal
                                  - NotEqual
                                  - Prefix
                                  - NotPrefix
                                  - Postfix
                                  - NotPostfix
                                  - GreaterThan
                                  - LessThan
                                  - GT
                                  - LT
                                  - Mask
                                  - SPort
                                  - NotSPort
                                  - SPortPriv
                                  - NotSportPriv
                                  - DPort
                                  - NotDPort
                                  - DPortPriv
                                  - NotDPortPriv
                                  - SAddr
                                  - NotSAddr
                                  - DAddr
                                  - NotDAddr
                                  - Protocol
                                  - Family
                                  - State
                                  - InMap
                                  - NotInMap
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - index
                              - operator
                              type: object
                            type: array
                          matchBinaries:
                            description: A list of binary exec name filters.
                            items:
                              properties:
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - In
                                  - NotIn
                                  - Prefix
                                  - NotPrefix
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchCapabilities:
                            description: A list of capabilities and IDs
                            items:
                              properties:
                                isNamespaceCapability:
                                  default: false
                                  description: Indicates whether these caps are namespace
                                    caps.
                                  type: boolean
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                type:
                                  default: Effective
                                  description: Type of capabilities
                                  enum:
                                  - Effective
                                  - Inheritable
                                  - Permitted
                                  type: string
                                values:
                                  description: Capabilities to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchCapabilityChanges:
                            description: IDs for capabilities changes
                            items:
                              properties:
                                isNamespaceCapability:
                                  default: false
                                  description: Indicates whether these caps are namespace
                                    caps.
                                  type: boolean
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                type:
                                  default: Effective
                                  description: Type of capabilities
                                  enum:
                                  - Effective
                                  - Inheritable
                                  - Permitted
                                  type: string
                                values:
                                  description: Capabilities to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchNamespaceChanges:
                            description: IDs for namespace changes
                            items:
                              properties:
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Namespace types (e.g., Mnt, Pid) to
                                    match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchNamespaces:
                            description: A list of namespaces and IDs
                            items:
                              properties:
                                namespace:
                                  description: Namespace selector name.
                                  enum:
                                  - Uts
                                  - Ipc
                                  - Mnt
                                  - Pid
                                  - PidForChildren
                                  - Net
                                  - Time
                                  - TimeForChildren
                                  - Cgroup
                                  - User
                                  type: string
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Namespace IDs (or host_ns for host
                                    namespace) of namespaces to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - namespace
                              - operator
                              - values
                              type: object
                            type: array
                          matchPIDs:
                            description: A list of process ID filters. MatchPIDs are
                              ANDed.
                            items:
                              properties:
                                followForks:
                                  default: false
                                  description: Matches any descendant processes of
                                    the matching PIDs.
                                  type: boolean
                                isNamespacePID:
                                  default: false
                                  description: Indicates whether PIDs are namespace
                                    PIDs.
                                  type: boolean
                                operator:
                                  description: PID selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Process IDs to match.
                                  items:
                                    format: int32
                                    type: integer
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchReturnActions:
                            description: A list of actions to execute when MatchReturnArgs
                              selector matches
                            items:
                              properties:
                                action:
                                  description: Action to execute.
                                  enum:
                                  - Post
                                  - FollowFD
                                  - UnfollowFD
                                  - Sigkill
                                  - CopyFD
                                  - Override
                                  - GetUrl
                                  - DnsLookup
                                  - NoPost
                                  - Signal
                                  - TrackSock
                                  - UntrackSock
                                  - NotifyKiller
                                  type: string
                                argError:
                                  description: error value for override action
                                  format: int32
                                  type: integer
                                argFd:
                                  description: An arg index for the fd for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argFqdn:
                                  description: A FQDN to lookup for the dnsLookup
                                    action
                                  type: string
                                argName:
                                  description: An arg index for the filename for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argSig:
                                  description: A signal number for signal action
                                  format: int32
                                  type: integer
                                argSock:
                                  description: An arg index for the sock for trackSock
                                    and untrackSock actions
                                  format: int32
                                  type: integer
                                argUrl:
                                  description: A URL for the getUrl action
                                  type: string
                                rateLimit:
                                  description: A time period within which repeated
                                    messages will not be posted. Can be specified
                                    in seconds (default or with 's' suffix), minutes
                                    ('m' suffix) or hours ('h' suffix). Only valid
                                    with the post action.
                                  type: string
                                rateLimitScope:
                                  description: The scope of the provided rate limit
                                    argument. Can be "thread" (default), "process"
                                    (all threads for the same process), or "global".
                                    If "thread" is selected then rate limiting applies
                                    per thread; if "process" is selected then rate
                                    limiting applies per process; if "global" is selected
                                    then rate limiting applies regardless of which
                                    process or thread caused the action. Only valid
                                    with the post action and with a rateLimit specified.
                                  type: string
                                stackTrace:
                                  description: Enable stack trace export. Only valid
                                    with the post action.
                                  type: boolean
                              required:
                              - action
                              type: object
                            type: array
                          matchReturnArgs:
                            description: A list of argument filters. MatchArgs are
                              ANDed.
                            items:
                              properties:
                                index:
                                  description: Position of the argument to apply fhe
                                    filter to.
                                  format: int32
                                  minimum: 0
                                  type: integer
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - Equal
                                  - NotEqual
                                  - Prefix
                                  - NotPrefix
                                  - Postfix
                                  - NotPostfix
                                  - GreaterThan
                                  - LessThan
                                  - GT
                                  - LT
                                  - Mask
                                  - SPort
                                  - NotSPort
                                  - SPortPriv
                                  - NotSportPriv
                                  - DPort
                                  - NotDPort
                                  - DPortPriv
                                  - NotDPortPriv
                                  - SAddr
                                  - NotSAddr
                                  - DAddr
                                  - NotDAddr
                                  - Protocol
                                  - Family
                                  - State
                                  - InMap
                                  - NotInMap
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - index
                              - operator
                              type: object
                            type: array
                        type: object
                      type: array
                    symbols:
                      description: List of the traced symbols
                      items:
                        type: string
                      type: array
                  required:
                  - path
                  - symbols
                  type: object
                type: array
            type: object
        required:
        - metadata
        - spec
        type: object
    served: true
    storage: true
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
---
# Source: qualys-tc/charts/runtimeSensor/templates/runtime-sensor-tracingpoliciesnamespaced.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.13.0
  creationTimestamp: null
  name: tracingpoliciesnamespaced.cilium.io
spec:
  group: cilium.io
  names:
    kind: TracingPolicyNamespaced
    listKind: TracingPolicyNamespacedList
    plural: tracingpoliciesnamespaced
    singular: tracingpolicynamespaced
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: Tracing policy specification.
            properties:
              killers:
                description: A killer spec.
                items:
                  properties:
                    calls:
                      description: Calls where killer is executed in
                      items:
                        type: string
                      type: array
                  required:
                  - calls
                  type: object
                type: array
              kprobes:
                description: A list of kprobe specs.
                items:
                  properties:
                    args:
                      description: A list of function arguments to include in the
                        trace output.
                      items:
                        properties:
                          index:
                            description: Position of the argument.
                            format: int32
                            minimum: 0
                            type: integer
                          label:
                            description: Label to output in the JSON
                            type: string
                          maxData:
                            default: false
                            description: Read maximum possible data (currently 327360).
                              This field is only used for char_buff data. When this
                              value is false (default), the bpf program will fetch
                              at most 4096 bytes. In later kernels (>=5.4) tetragon
                              supports fetching up to 327360 bytes if this flag is
                              turned on
                            type: boolean
                          returnCopy:
                            default: false
                            description: This field is used only for char_buf and
                              char_iovec types. It indicates that this argument should
                              be read later (when the kretprobe for the symbol is
                              triggered) because it might not be populated when the
                              kprobe is triggered at the entrance of the function.
                              For example, a buffer supplied to read(2) won't have
                              content until kretprobe is triggered.
                            type: boolean
                          sizeArgIndex:
                            description: Specifies the position of the corresponding
                              size argument for this argument. This field is used
                              only for char_buf and char_iovec types.
                            format: int32
                            minimum: 0
                            type: integer
                          type:
                            default: auto
                            description: Argument type.
                            enum:
                            - auto
                            - int
                            - int8
                            - uint8
                            - int16
                            - uint16
                            - uint32
                            - int32
                            - uint64
                            - int64
                            - char_buf
                            - char_iovec
                            - size_t
                            - skb
                            - sock
                            - string
                            - fd
                            - file
                            - filename
                            - path
                            - nop
                            - bpf_attr
                            - perf_event
                            - bpf_map
                            - user_namespace
                            - capability
                            - kiocb
                            - iov_iter
                            - cred
                            - load_info
                            - module
                            - syscall64
                            - kernel_cap_t
                            - cap_inheritable
                            - cap_permitted
                            - cap_effective
                            type: string
                        required:
                        - index
                        - type
                        type: object
                      type: array
                    call:
                      description: Name of the function to apply the kprobe spec to.
                      type: string
                    message:
                      description: A short message of 256 characters max that will
                        be included in the event output to inform users what is going
                        on.
                      type: string
                    return:
                      default: false
                      description: Indicates whether to collect return value of the
                        traced function.
                      type: boolean
                    returnArg:
                      description: A return argument to include in the trace output.
                      properties:
                        index:
                          description: Position of the argument.
                          format: int32
                          minimum: 0
                          type: integer
                        label:
                          description: Label to output in the JSON
                          type: string
                        maxData:
                          default: false
                          description: Read maximum possible data (currently 327360).
                            This field is only used for char_buff data. When this
                            value is false (default), the bpf program will fetch at
                            most 4096 bytes. In later kernels (>=5.4) tetragon supports
                            fetching up to 327360 bytes if this flag is turned on
                          type: boolean
                        returnCopy:
                          default: false
                          description: This field is used only for char_buf and char_iovec
                            types. It indicates that this argument should be read
                            later (when the kretprobe for the symbol is triggered)
                            because it might not be populated when the kprobe is triggered
                            at the entrance of the function. For example, a buffer
                            supplied to read(2) won't have content until kretprobe
                            is triggered.
                          type: boolean
                        sizeArgIndex:
                          description: Specifies the position of the corresponding
                            size argument for this argument. This field is used only
                            for char_buf and char_iovec types.
                          format: int32
                          minimum: 0
                          type: integer
                        type:
                          default: auto
                          description: Argument type.
                          enum:
                          - auto
                          - int
                          - int8
                          - uint8
                          - int16
                          - uint16
                          - uint32
                          - int32
                          - uint64
                          - int64
                          - char_buf
                          - char_iovec
                          - size_t
                          - skb
                          - sock
                          - string
                          - fd
                          - file
                          - filename
                          - path
                          - nop
                          - bpf_attr
                          - perf_event
                          - bpf_map
                          - user_namespace
                          - capability
                          - kiocb
                          - iov_iter
                          - cred
                          - load_info
                          - module
                          - syscall64
                          - kernel_cap_t
                          - cap_inheritable
                          - cap_permitted
                          - cap_effective
                          type: string
                      required:
                      - index
                      - type
                      type: object
                    returnArgAction:
                      description: 'An action to perform on the return argument. Available
                        actions are: Post;TrackSock;UntrackSock'
                      type: string
                    selectors:
                      description: Selectors to apply before producing trace output.
                        Selectors are ORed.
                      items:
                        description: KProbeSelector selects function calls for kprobe
                          based on PIDs and function arguments. The results of MatchPIDs
                          and MatchArgs are ANDed.
                        properties:
                          matchActions:
                            description: A list of actions to execute when this selector
                              matches
                            items:
                              properties:
                                action:
                                  description: Action to execute.
                                  enum:
                                  - Post
                                  - FollowFD
                                  - UnfollowFD
                                  - Sigkill
                                  - CopyFD
                                  - Override
                                  - GetUrl
                                  - DnsLookup
                                  - NoPost
                                  - Signal
                                  - TrackSock
                                  - UntrackSock
                                  - NotifyKiller
                                  type: string
                                argError:
                                  description: error value for override action
                                  format: int32
                                  type: integer
                                argFd:
                                  description: An arg index for the fd for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argFqdn:
                                  description: A FQDN to lookup for the dnsLookup
                                    action
                                  type: string
                                argName:
                                  description: An arg index for the filename for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argSig:
                                  description: A signal number for signal action
                                  format: int32
                                  type: integer
                                argSock:
                                  description: An arg index for the sock for trackSock
                                    and untrackSock actions
                                  format: int32
                                  type: integer
                                argUrl:
                                  description: A URL for the getUrl action
                                  type: string
                                rateLimit:
                                  description: A time period within which repeated
                                    messages will not be posted. Can be specified
                                    in seconds (default or with 's' suffix), minutes
                                    ('m' suffix) or hours ('h' suffix). Only valid
                                    with the post action.
                                  type: string
                                rateLimitScope:
                                  description: The scope of the provided rate limit
                                    argument. Can be "thread" (default), "process"
                                    (all threads for the same process), or "global".
                                    If "thread" is selected then rate limiting applies
                                    per thread; if "process" is selected then rate
                                    limiting applies per process; if "global" is selected
                                    then rate limiting applies regardless of which
                                    process or thread caused the action. Only valid
                                    with the post action and with a rateLimit specified.
                                  type: string
                                stackTrace:
                                  description: Enable stack trace export. Only valid
                                    with the post action.
                                  type: boolean
                              required:
                              - action
                              type: object
                            type: array
                          matchArgs:
                            description: A list of argument filters. MatchArgs are
                              ANDed.
                            items:
                              properties:
                                index:
                                  description: Position of the argument to apply fhe
                                    filter to.
                                  format: int32
                                  minimum: 0
                                  type: integer
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - Equal
                                  - NotEqual
                                  - Prefix
                                  - NotPrefix
                                  - Postfix
                                  - NotPostfix
                                  - GreaterThan
                                  - LessThan
                                  - GT
                                  - LT
                                  - Mask
                                  - SPort
                                  - NotSPort
                                  - SPortPriv
                                  - NotSportPriv
                                  - DPort
                                  - NotDPort
                                  - DPortPriv
                                  - NotDPortPriv
                                  - SAddr
                                  - NotSAddr
                                  - DAddr
                                  - NotDAddr
                                  - Protocol
                                  - Family
                                  - State
                                  - InMap
                                  - NotInMap
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - index
                              - operator
                              type: object
                            type: array
                          matchBinaries:
                            description: A list of binary exec name filters.
                            items:
                              properties:
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - In
                                  - NotIn
                                  - Prefix
                                  - NotPrefix
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchCapabilities:
                            description: A list of capabilities and IDs
                            items:
                              properties:
                                isNamespaceCapability:
                                  default: false
                                  description: Indicates whether these caps are namespace
                                    caps.
                                  type: boolean
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                type:
                                  default: Effective
                                  description: Type of capabilities
                                  enum:
                                  - Effective
                                  - Inheritable
                                  - Permitted
                                  type: string
                                values:
                                  description: Capabilities to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchCapabilityChanges:
                            description: IDs for capabilities changes
                            items:
                              properties:
                                isNamespaceCapability:
                                  default: false
                                  description: Indicates whether these caps are namespace
                                    caps.
                                  type: boolean
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                type:
                                  default: Effective
                                  description: Type of capabilities
                                  enum:
                                  - Effective
                                  - Inheritable
                                  - Permitted
                                  type: string
                                values:
                                  description: Capabilities to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchNamespaceChanges:
                            description: IDs for namespace changes
                            items:
                              properties:
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Namespace types (e.g., Mnt, Pid) to
                                    match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchNamespaces:
                            description: A list of namespaces and IDs
                            items:
                              properties:
                                namespace:
                                  description: Namespace selector name.
                                  enum:
                                  - Uts
                                  - Ipc
                                  - Mnt
                                  - Pid
                                  - PidForChildren
                                  - Net
                                  - Time
                                  - TimeForChildren
                                  - Cgroup
                                  - User
                                  type: string
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Namespace IDs (or host_ns for host
                                    namespace) of namespaces to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - namespace
                              - operator
                              - values
                              type: object
                            type: array
                          matchPIDs:
                            description: A list of process ID filters. MatchPIDs are
                              ANDed.
                            items:
                              properties:
                                followForks:
                                  default: false
                                  description: Matches any descendant processes of
                                    the matching PIDs.
                                  type: boolean
                                isNamespacePID:
                                  default: false
                                  description: Indicates whether PIDs are namespace
                                    PIDs.
                                  type: boolean
                                operator:
                                  description: PID selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Process IDs to match.
                                  items:
                                    format: int32
                                    type: integer
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchReturnActions:
                            description: A list of actions to execute when MatchReturnArgs
                              selector matches
                            items:
                              properties:
                                action:
                                  description: Action to execute.
                                  enum:
                                  - Post
                                  - FollowFD
                                  - UnfollowFD
                                  - Sigkill
                                  - CopyFD
                                  - Override
                                  - GetUrl
                                  - DnsLookup
                                  - NoPost
                                  - Signal
                                  - TrackSock
                                  - UntrackSock
                                  - NotifyKiller
                                  type: string
                                argError:
                                  description: error value for override action
                                  format: int32
                                  type: integer
                                argFd:
                                  description: An arg index for the fd for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argFqdn:
                                  description: A FQDN to lookup for the dnsLookup
                                    action
                                  type: string
                                argName:
                                  description: An arg index for the filename for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argSig:
                                  description: A signal number for signal action
                                  format: int32
                                  type: integer
                                argSock:
                                  description: An arg index for the sock for trackSock
                                    and untrackSock actions
                                  format: int32
                                  type: integer
                                argUrl:
                                  description: A URL for the getUrl action
                                  type: string
                                rateLimit:
                                  description: A time period within which repeated
                                    messages will not be posted. Can be specified
                                    in seconds (default or with 's' suffix), minutes
                                    ('m' suffix) or hours ('h' suffix). Only valid
                                    with the post action.
                                  type: string
                                rateLimitScope:
                                  description: The scope of the provided rate limit
                                    argument. Can be "thread" (default), "process"
                                    (all threads for the same process), or "global".
                                    If "thread" is selected then rate limiting applies
                                    per thread; if "process" is selected then rate
                                    limiting applies per process; if "global" is selected
                                    then rate limiting applies regardless of which
                                    process or thread caused the action. Only valid
                                    with the post action and with a rateLimit specified.
                                  type: string
                                stackTrace:
                                  description: Enable stack trace export. Only valid
                                    with the post action.
                                  type: boolean
                              required:
                              - action
                              type: object
                            type: array
                          matchReturnArgs:
                            description: A list of argument filters. MatchArgs are
                              ANDed.
                            items:
                              properties:
                                index:
                                  description: Position of the argument to apply fhe
                                    filter to.
                                  format: int32
                                  minimum: 0
                                  type: integer
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - Equal
                                  - NotEqual
                                  - Prefix
                                  - NotPrefix
                                  - Postfix
                                  - NotPostfix
                                  - GreaterThan
                                  - LessThan
                                  - GT
                                  - LT
                                  - Mask
                                  - SPort
                                  - NotSPort
                                  - SPortPriv
                                  - NotSportPriv
                                  - DPort
                                  - NotDPort
                                  - DPortPriv
                                  - NotDPortPriv
                                  - SAddr
                                  - NotSAddr
                                  - DAddr
                                  - NotDAddr
                                  - Protocol
                                  - Family
                                  - State
                                  - InMap
                                  - NotInMap
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - index
                              - operator
                              type: object
                            type: array
                        type: object
                      type: array
                    syscall:
                      default: true
                      description: Indicates whether the traced function is a syscall.
                      type: boolean
                  required:
                  - call
                  type: object
                type: array
              lists:
                description: A list of list specs.
                items:
                  properties:
                    name:
                      description: Name of the list
                      type: string
                    pattern:
                      description: Pattern for 'generated' lists.
                      type: string
                    type:
                      description: Indicates the type of the list values.
                      enum:
                      - syscalls
                      - generated_syscalls
                      - generated_ftrace
                      type: string
                    validated:
                      description: List was validated
                      type: boolean
                    values:
                      description: Values of the list
                      items:
                        type: string
                      type: array
                  required:
                  - name
                  type: object
                type: array
              loader:
                description: Enable loader events
                type: boolean
              options:
                description: A list of overloaded options
                items:
                  properties:
                    name:
                      description: Name of the option
                      type: string
                    value:
                      description: Value of the option
                      type: string
                  required:
                  - name
                  type: object
                type: array
              podSelector:
                description: PodSelector selects pods that this policy applies to
                properties:
                  matchExpressions:
                    description: matchExpressions is a list of label selector requirements.
                      The requirements are ANDed.
                    items:
                      description: A label selector requirement is a selector that
                        contains values, a key, and an operator that relates the key
                        and values.
                      properties:
                        key:
                          description: key is the label key that the selector applies
                            to.
                          type: string
                        operator:
                          description: operator represents a key's relationship to
                            a set of values. Valid operators are In, NotIn, Exists
                            and DoesNotExist.
                          enum:
                          - In
                          - NotIn
                          - Exists
                          - DoesNotExist
                          type: string
                        values:
                          description: values is an array of string values. If the
                            operator is In or NotIn, the values array must be non-empty.
                            If the operator is Exists or DoesNotExist, the values
                            array must be empty. This array is replaced during a strategic
                            merge patch.
                          items:
                            type: string
                          type: array
                      required:
                      - key
                      - operator
                      type: object
                    type: array
                  matchLabels:
                    additionalProperties:
                      description: MatchLabelsValue represents the value from the
                        MatchLabels {key,value} pair.
                      maxLength: 63
                      pattern: ^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$
                      type: string
                    description: matchLabels is a map of {key,value} pairs. A single
                      {key,value} in the matchLabels map is equivalent to an element
                      of matchExpressions, whose key field is "key", the operator
                      is "In", and the values array contains only "value". The requirements
                      are ANDed.
                    type: object
                type: object
              tracepoints:
                description: A list of tracepoint specs.
                items:
                  properties:
                    args:
                      description: A list of function arguments to include in the
                        trace output.
                      items:
                        properties:
                          index:
                            description: Position of the argument.
                            format: int32
                            minimum: 0
                            type: integer
                          label:
                            description: Label to output in the JSON
                            type: string
                          maxData:
                            default: false
                            description: Read maximum possible data (currently 327360).
                              This field is only used for char_buff data. When this
                              value is false (default), the bpf program will fetch
                              at most 4096 bytes. In later kernels (>=5.4) tetragon
                              supports fetching up to 327360 bytes if this flag is
                              turned on
                            type: boolean
                          returnCopy:
                            default: false
                            description: This field is used only for char_buf and
                              char_iovec types. It indicates that this argument should
                              be read later (when the kretprobe for the symbol is
                              triggered) because it might not be populated when the
                              kprobe is triggered at the entrance of the function.
                              For example, a buffer supplied to read(2) won't have
                              content until kretprobe is triggered.
                            type: boolean
                          sizeArgIndex:
                            description: Specifies the position of the corresponding
                              size argument for this argument. This field is used
                              only for char_buf and char_iovec types.
                            format: int32
                            minimum: 0
                            type: integer
                          type:
                            default: auto
                            description: Argument type.
                            enum:
                            - auto
                            - int
                            - int8
                            - uint8
                            - int16
                            - uint16
                            - uint32
                            - int32
                            - uint64
                            - int64
                            - char_buf
                            - char_iovec
                            - size_t
                            - skb
                            - sock
                            - string
                            - fd
                            - file
                            - filename
                            - path
                            - nop
                            - bpf_attr
                            - perf_event
                            - bpf_map
                            - user_namespace
                            - capability
                            - kiocb
                            - iov_iter
                            - cred
                            - load_info
                            - module
                            - syscall64
                            - kernel_cap_t
                            - cap_inheritable
                            - cap_permitted
                            - cap_effective
                            type: string
                        required:
                        - index
                        - type
                        type: object
                      type: array
                    event:
                      description: Tracepoint event
                      type: string
                    message:
                      description: A short message of 256 characters max that will
                        be included in the event output to inform users what is going
                        on.
                      type: string
                    selectors:
                      description: Selectors to apply before producing trace output.
                        Selectors are ORed.
                      items:
                        description: KProbeSelector selects function calls for kprobe
                          based on PIDs and function arguments. The results of MatchPIDs
                          and MatchArgs are ANDed.
                        properties:
                          matchActions:
                            description: A list of actions to execute when this selector
                              matches
                            items:
                              properties:
                                action:
                                  description: Action to execute.
                                  enum:
                                  - Post
                                  - FollowFD
                                  - UnfollowFD
                                  - Sigkill
                                  - CopyFD
                                  - Override
                                  - GetUrl
                                  - DnsLookup
                                  - NoPost
                                  - Signal
                                  - TrackSock
                                  - UntrackSock
                                  - NotifyKiller
                                  type: string
                                argError:
                                  description: error value for override action
                                  format: int32
                                  type: integer
                                argFd:
                                  description: An arg index for the fd for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argFqdn:
                                  description: A FQDN to lookup for the dnsLookup
                                    action
                                  type: string
                                argName:
                                  description: An arg index for the filename for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argSig:
                                  description: A signal number for signal action
                                  format: int32
                                  type: integer
                                argSock:
                                  description: An arg index for the sock for trackSock
                                    and untrackSock actions
                                  format: int32
                                  type: integer
                                argUrl:
                                  description: A URL for the getUrl action
                                  type: string
                                rateLimit:
                                  description: A time period within which repeated
                                    messages will not be posted. Can be specified
                                    in seconds (default or with 's' suffix), minutes
                                    ('m' suffix) or hours ('h' suffix). Only valid
                                    with the post action.
                                  type: string
                                rateLimitScope:
                                  description: The scope of the provided rate limit
                                    argument. Can be "thread" (default), "process"
                                    (all threads for the same process), or "global".
                                    If "thread" is selected then rate limiting applies
                                    per thread; if "process" is selected then rate
                                    limiting applies per process; if "global" is selected
                                    then rate limiting applies regardless of which
                                    process or thread caused the action. Only valid
                                    with the post action and with a rateLimit specified.
                                  type: string
                                stackTrace:
                                  description: Enable stack trace export. Only valid
                                    with the post action.
                                  type: boolean
                              required:
                              - action
                              type: object
                            type: array
                          matchArgs:
                            description: A list of argument filters. MatchArgs are
                              ANDed.
                            items:
                              properties:
                                index:
                                  description: Position of the argument to apply fhe
                                    filter to.
                                  format: int32
                                  minimum: 0
                                  type: integer
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - Equal
                                  - NotEqual
                                  - Prefix
                                  - NotPrefix
                                  - Postfix
                                  - NotPostfix
                                  - GreaterThan
                                  - LessThan
                                  - GT
                                  - LT
                                  - Mask
                                  - SPort
                                  - NotSPort
                                  - SPortPriv
                                  - NotSportPriv
                                  - DPort
                                  - NotDPort
                                  - DPortPriv
                                  - NotDPortPriv
                                  - SAddr
                                  - NotSAddr
                                  - DAddr
                                  - NotDAddr
                                  - Protocol
                                  - Family
                                  - State
                                  - InMap
                                  - NotInMap
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - index
                              - operator
                              type: object
                            type: array
                          matchBinaries:
                            description: A list of binary exec name filters.
                            items:
                              properties:
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - In
                                  - NotIn
                                  - Prefix
                                  - NotPrefix
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchCapabilities:
                            description: A list of capabilities and IDs
                            items:
                              properties:
                                isNamespaceCapability:
                                  default: false
                                  description: Indicates whether these caps are namespace
                                    caps.
                                  type: boolean
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                type:
                                  default: Effective
                                  description: Type of capabilities
                                  enum:
                                  - Effective
                                  - Inheritable
                                  - Permitted
                                  type: string
                                values:
                                  description: Capabilities to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchCapabilityChanges:
                            description: IDs for capabilities changes
                            items:
                              properties:
                                isNamespaceCapability:
                                  default: false
                                  description: Indicates whether these caps are namespace
                                    caps.
                                  type: boolean
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                type:
                                  default: Effective
                                  description: Type of capabilities
                                  enum:
                                  - Effective
                                  - Inheritable
                                  - Permitted
                                  type: string
                                values:
                                  description: Capabilities to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchNamespaceChanges:
                            description: IDs for namespace changes
                            items:
                              properties:
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Namespace types (e.g., Mnt, Pid) to
                                    match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchNamespaces:
                            description: A list of namespaces and IDs
                            items:
                              properties:
                                namespace:
                                  description: Namespace selector name.
                                  enum:
                                  - Uts
                                  - Ipc
                                  - Mnt
                                  - Pid
                                  - PidForChildren
                                  - Net
                                  - Time
                                  - TimeForChildren
                                  - Cgroup
                                  - User
                                  type: string
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Namespace IDs (or host_ns for host
                                    namespace) of namespaces to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - namespace
                              - operator
                              - values
                              type: object
                            type: array
                          matchPIDs:
                            description: A list of process ID filters. MatchPIDs are
                              ANDed.
                            items:
                              properties:
                                followForks:
                                  default: false
                                  description: Matches any descendant processes of
                                    the matching PIDs.
                                  type: boolean
                                isNamespacePID:
                                  default: false
                                  description: Indicates whether PIDs are namespace
                                    PIDs.
                                  type: boolean
                                operator:
                                  description: PID selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Process IDs to match.
                                  items:
                                    format: int32
                                    type: integer
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchReturnActions:
                            description: A list of actions to execute when MatchReturnArgs
                              selector matches
                            items:
                              properties:
                                action:
                                  description: Action to execute.
                                  enum:
                                  - Post
                                  - FollowFD
                                  - UnfollowFD
                                  - Sigkill
                                  - CopyFD
                                  - Override
                                  - GetUrl
                                  - DnsLookup
                                  - NoPost
                                  - Signal
                                  - TrackSock
                                  - UntrackSock
                                  - NotifyKiller
                                  type: string
                                argError:
                                  description: error value for override action
                                  format: int32
                                  type: integer
                                argFd:
                                  description: An arg index for the fd for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argFqdn:
                                  description: A FQDN to lookup for the dnsLookup
                                    action
                                  type: string
                                argName:
                                  description: An arg index for the filename for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argSig:
                                  description: A signal number for signal action
                                  format: int32
                                  type: integer
                                argSock:
                                  description: An arg index for the sock for trackSock
                                    and untrackSock actions
                                  format: int32
                                  type: integer
                                argUrl:
                                  description: A URL for the getUrl action
                                  type: string
                                rateLimit:
                                  description: A time period within which repeated
                                    messages will not be posted. Can be specified
                                    in seconds (default or with 's' suffix), minutes
                                    ('m' suffix) or hours ('h' suffix). Only valid
                                    with the post action.
                                  type: string
                                rateLimitScope:
                                  description: The scope of the provided rate limit
                                    argument. Can be "thread" (default), "process"
                                    (all threads for the same process), or "global".
                                    If "thread" is selected then rate limiting applies
                                    per thread; if "process" is selected then rate
                                    limiting applies per process; if "global" is selected
                                    then rate limiting applies regardless of which
                                    process or thread caused the action. Only valid
                                    with the post action and with a rateLimit specified.
                                  type: string
                                stackTrace:
                                  description: Enable stack trace export. Only valid
                                    with the post action.
                                  type: boolean
                              required:
                              - action
                              type: object
                            type: array
                          matchReturnArgs:
                            description: A list of argument filters. MatchArgs are
                              ANDed.
                            items:
                              properties:
                                index:
                                  description: Position of the argument to apply fhe
                                    filter to.
                                  format: int32
                                  minimum: 0
                                  type: integer
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - Equal
                                  - NotEqual
                                  - Prefix
                                  - NotPrefix
                                  - Postfix
                                  - NotPostfix
                                  - GreaterThan
                                  - LessThan
                                  - GT
                                  - LT
                                  - Mask
                                  - SPort
                                  - NotSPort
                                  - SPortPriv
                                  - NotSportPriv
                                  - DPort
                                  - NotDPort
                                  - DPortPriv
                                  - NotDPortPriv
                                  - SAddr
                                  - NotSAddr
                                  - DAddr
                                  - NotDAddr
                                  - Protocol
                                  - Family
                                  - State
                                  - InMap
                                  - NotInMap
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - index
                              - operator
                              type: object
                            type: array
                        type: object
                      type: array
                    subsystem:
                      description: Tracepoint subsystem
                      type: string
                  required:
                  - event
                  - subsystem
                  type: object
                type: array
              uprobes:
                description: A list of uprobe specs.
                items:
                  properties:
                    args:
                      description: A list of function arguments to include in the
                        trace output.
                      items:
                        properties:
                          index:
                            description: Position of the argument.
                            format: int32
                            minimum: 0
                            type: integer
                          label:
                            description: Label to output in the JSON
                            type: string
                          maxData:
                            default: false
                            description: Read maximum possible data (currently 327360).
                              This field is only used for char_buff data. When this
                              value is false (default), the bpf program will fetch
                              at most 4096 bytes. In later kernels (>=5.4) tetragon
                              supports fetching up to 327360 bytes if this flag is
                              turned on
                            type: boolean
                          returnCopy:
                            default: false
                            description: This field is used only for char_buf and
                              char_iovec types. It indicates that this argument should
                              be read later (when the kretprobe for the symbol is
                              triggered) because it might not be populated when the
                              kprobe is triggered at the entrance of the function.
                              For example, a buffer supplied to read(2) won't have
                              content until kretprobe is triggered.
                            type: boolean
                          sizeArgIndex:
                            description: Specifies the position of the corresponding
                              size argument for this argument. This field is used
                              only for char_buf and char_iovec types.
                            format: int32
                            minimum: 0
                            type: integer
                          type:
                            default: auto
                            description: Argument type.
                            enum:
                            - auto
                            - int
                            - int8
                            - uint8
                            - int16
                            - uint16
                            - uint32
                            - int32
                            - uint64
                            - int64
                            - char_buf
                            - char_iovec
                            - size_t
                            - skb
                            - sock
                            - string
                            - fd
                            - file
                            - filename
                            - path
                            - nop
                            - bpf_attr
                            - perf_event
                            - bpf_map
                            - user_namespace
                            - capability
                            - kiocb
                            - iov_iter
                            - cred
                            - load_info
                            - module
                            - syscall64
                            - kernel_cap_t
                            - cap_inheritable
                            - cap_permitted
                            - cap_effective
                            type: string
                        required:
                        - index
                        - type
                        type: object
                      type: array
                    message:
                      description: A short message of 256 characters max that will
                        be included in the event output to inform users what is going
                        on.
                      type: string
                    path:
                      description: Name of the traced binary
                      type: string
                    selectors:
                      description: Selectors to apply before producing trace output.
                        Selectors are ORed.
                      items:
                        description: KProbeSelector selects function calls for kprobe
                          based on PIDs and function arguments. The results of MatchPIDs
                          and MatchArgs are ANDed.
                        properties:
                          matchActions:
                            description: A list of actions to execute when this selector
                              matches
                            items:
                              properties:
                                action:
                                  description: Action to execute.
                                  enum:
                                  - Post
                                  - FollowFD
                                  - UnfollowFD
                                  - Sigkill
                                  - CopyFD
                                  - Override
                                  - GetUrl
                                  - DnsLookup
                                  - NoPost
                                  - Signal
                                  - TrackSock
                                  - UntrackSock
                                  - NotifyKiller
                                  type: string
                                argError:
                                  description: error value for override action
                                  format: int32
                                  type: integer
                                argFd:
                                  description: An arg index for the fd for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argFqdn:
                                  description: A FQDN to lookup for the dnsLookup
                                    action
                                  type: string
                                argName:
                                  description: An arg index for the filename for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argSig:
                                  description: A signal number for signal action
                                  format: int32
                                  type: integer
                                argSock:
                                  description: An arg index for the sock for trackSock
                                    and untrackSock actions
                                  format: int32
                                  type: integer
                                argUrl:
                                  description: A URL for the getUrl action
                                  type: string
                                rateLimit:
                                  description: A time period within which repeated
                                    messages will not be posted. Can be specified
                                    in seconds (default or with 's' suffix), minutes
                                    ('m' suffix) or hours ('h' suffix). Only valid
                                    with the post action.
                                  type: string
                                rateLimitScope:
                                  description: The scope of the provided rate limit
                                    argument. Can be "thread" (default), "process"
                                    (all threads for the same process), or "global".
                                    If "thread" is selected then rate limiting applies
                                    per thread; if "process" is selected then rate
                                    limiting applies per process; if "global" is selected
                                    then rate limiting applies regardless of which
                                    process or thread caused the action. Only valid
                                    with the post action and with a rateLimit specified.
                                  type: string
                                stackTrace:
                                  description: Enable stack trace export. Only valid
                                    with the post action.
                                  type: boolean
                              required:
                              - action
                              type: object
                            type: array
                          matchArgs:
                            description: A list of argument filters. MatchArgs are
                              ANDed.
                            items:
                              properties:
                                index:
                                  description: Position of the argument to apply fhe
                                    filter to.
                                  format: int32
                                  minimum: 0
                                  type: integer
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - Equal
                                  - NotEqual
                                  - Prefix
                                  - NotPrefix
                                  - Postfix
                                  - NotPostfix
                                  - GreaterThan
                                  - LessThan
                                  - GT
                                  - LT
                                  - Mask
                                  - SPort
                                  - NotSPort
                                  - SPortPriv
                                  - NotSportPriv
                                  - DPort
                                  - NotDPort
                                  - DPortPriv
                                  - NotDPortPriv
                                  - SAddr
                                  - NotSAddr
                                  - DAddr
                                  - NotDAddr
                                  - Protocol
                                  - Family
                                  - State
                                  - InMap
                                  - NotInMap
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - index
                              - operator
                              type: object
                            type: array
                          matchBinaries:
                            description: A list of binary exec name filters.
                            items:
                              properties:
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - In
                                  - NotIn
                                  - Prefix
                                  - NotPrefix
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchCapabilities:
                            description: A list of capabilities and IDs
                            items:
                              properties:
                                isNamespaceCapability:
                                  default: false
                                  description: Indicates whether these caps are namespace
                                    caps.
                                  type: boolean
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                type:
                                  default: Effective
                                  description: Type of capabilities
                                  enum:
                                  - Effective
                                  - Inheritable
                                  - Permitted
                                  type: string
                                values:
                                  description: Capabilities to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchCapabilityChanges:
                            description: IDs for capabilities changes
                            items:
                              properties:
                                isNamespaceCapability:
                                  default: false
                                  description: Indicates whether these caps are namespace
                                    caps.
                                  type: boolean
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                type:
                                  default: Effective
                                  description: Type of capabilities
                                  enum:
                                  - Effective
                                  - Inheritable
                                  - Permitted
                                  type: string
                                values:
                                  description: Capabilities to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchNamespaceChanges:
                            description: IDs for namespace changes
                            items:
                              properties:
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Namespace types (e.g., Mnt, Pid) to
                                    match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchNamespaces:
                            description: A list of namespaces and IDs
                            items:
                              properties:
                                namespace:
                                  description: Namespace selector name.
                                  enum:
                                  - Uts
                                  - Ipc
                                  - Mnt
                                  - Pid
                                  - PidForChildren
                                  - Net
                                  - Time
                                  - TimeForChildren
                                  - Cgroup
                                  - User
                                  type: string
                                operator:
                                  description: Namespace selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Namespace IDs (or host_ns for host
                                    namespace) of namespaces to match.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - namespace
                              - operator
                              - values
                              type: object
                            type: array
                          matchPIDs:
                            description: A list of process ID filters. MatchPIDs are
                              ANDed.
                            items:
                              properties:
                                followForks:
                                  default: false
                                  description: Matches any descendant processes of
                                    the matching PIDs.
                                  type: boolean
                                isNamespacePID:
                                  default: false
                                  description: Indicates whether PIDs are namespace
                                    PIDs.
                                  type: boolean
                                operator:
                                  description: PID selector operator.
                                  enum:
                                  - In
                                  - NotIn
                                  type: string
                                values:
                                  description: Process IDs to match.
                                  items:
                                    format: int32
                                    type: integer
                                  type: array
                              required:
                              - operator
                              - values
                              type: object
                            type: array
                          matchReturnActions:
                            description: A list of actions to execute when MatchReturnArgs
                              selector matches
                            items:
                              properties:
                                action:
                                  description: Action to execute.
                                  enum:
                                  - Post
                                  - FollowFD
                                  - UnfollowFD
                                  - Sigkill
                                  - CopyFD
                                  - Override
                                  - GetUrl
                                  - DnsLookup
                                  - NoPost
                                  - Signal
                                  - TrackSock
                                  - UntrackSock
                                  - NotifyKiller
                                  type: string
                                argError:
                                  description: error value for override action
                                  format: int32
                                  type: integer
                                argFd:
                                  description: An arg index for the fd for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argFqdn:
                                  description: A FQDN to lookup for the dnsLookup
                                    action
                                  type: string
                                argName:
                                  description: An arg index for the filename for fdInstall
                                    action
                                  format: int32
                                  type: integer
                                argSig:
                                  description: A signal number for signal action
                                  format: int32
                                  type: integer
                                argSock:
                                  description: An arg index for the sock for trackSock
                                    and untrackSock actions
                                  format: int32
                                  type: integer
                                argUrl:
                                  description: A URL for the getUrl action
                                  type: string
                                rateLimit:
                                  description: A time period within which repeated
                                    messages will not be posted. Can be specified
                                    in seconds (default or with 's' suffix), minutes
                                    ('m' suffix) or hours ('h' suffix). Only valid
                                    with the post action.
                                  type: string
                                rateLimitScope:
                                  description: The scope of the provided rate limit
                                    argument. Can be "thread" (default), "process"
                                    (all threads for the same process), or "global".
                                    If "thread" is selected then rate limiting applies
                                    per thread; if "process" is selected then rate
                                    limiting applies per process; if "global" is selected
                                    then rate limiting applies regardless of which
                                    process or thread caused the action. Only valid
                                    with the post action and with a rateLimit specified.
                                  type: string
                                stackTrace:
                                  description: Enable stack trace export. Only valid
                                    with the post action.
                                  type: boolean
                              required:
                              - action
                              type: object
                            type: array
                          matchReturnArgs:
                            description: A list of argument filters. MatchArgs are
                              ANDed.
                            items:
                              properties:
                                index:
                                  description: Position of the argument to apply fhe
                                    filter to.
                                  format: int32
                                  minimum: 0
                                  type: integer
                                operator:
                                  description: Filter operation.
                                  enum:
                                  - Equal
                                  - NotEqual
                                  - Prefix
                                  - NotPrefix
                                  - Postfix
                                  - NotPostfix
                                  - GreaterThan
                                  - LessThan
                                  - GT
                                  - LT
                                  - Mask
                                  - SPort
                                  - NotSPort
                                  - SPortPriv
                                  - NotSportPriv
                                  - DPort
                                  - NotDPort
                                  - DPortPriv
                                  - NotDPortPriv
                                  - SAddr
                                  - NotSAddr
                                  - DAddr
                                  - NotDAddr
                                  - Protocol
                                  - Family
                                  - State
                                  - InMap
                                  - NotInMap
                                  type: string
                                values:
                                  description: Value to compare the argument against.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - index
                              - operator
                              type: object
                            type: array
                        type: object
                      type: array
                    symbols:
                      description: List of the traced symbols
                      items:
                        type: string
                      type: array
                  required:
                  - path
                  - symbols
                  type: object
                type: array
            type: object
        required:
        - metadata
        - spec
        type: object
    served: true
    storage: true
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
---
# Source: qualys-tc/charts/admissionController/templates/cluster-role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: admission-controller
rules:
  - apiGroups: ["cs.qualys.com"]
    resources: [admission-controller]
    verbs: [ "get", "list", "watch", "create" ]
  - apiGroups: [ "" ]
    resources: [ "namespaces" ]
    verbs: [ "get", "list" ]
  - apiGroups: [ "" ]
    resources: [ "nodes" ]
    verbs: [ "get", "list" ]
---
# Source: qualys-tc/charts/clusterSensor/templates/clustersensor-clusterrole.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: qualys-clustersensor-cluster-reader-role
rules:
- apiGroups: [""]
  resources: ["pods", "namespaces", "nodes", "services", "serviceaccounts"]
  verbs: ["get", "watch", "list"]
- apiGroups: ["apps"]
  resources: ["deployments", "replicasets","statefulsets", "daemonsets","replicationcontrollers"]
  verbs: ["get"]
- apiGroups: ["batch"]
  resources: ["jobs","cronjobs"]
  verbs: ["get"]
- apiGroups: ["apiextensions.k8s.io"]
  resources: ["customresourcedefinitions"]
  verbs: ["get", "list"]
- apiGroups: [ "discovery.k8s.io" ]
  resources: [ "endpointslices" ]
  verbs: [ "get", "list", "watch" ]
- apiGroups: [ "networking.k8s.io" ]
  resources: [ "ingresses" ]
  verbs: [ "get", "list", "watch" ]
---
# Source: qualys-tc/charts/qcsSensor/templates/cssensor-clusterrole.yaml
# ClusterRole for read permission to whole cluster
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: qualys-cluster-reader-role
rules:
  - apiGroups: [""]
    resources: ["nodes", "pods/status", "replicationcontrollers/status", "nodes/status", "namespaces"]
    verbs: ["get"]
  - apiGroups: [""]
    resources: ["pods"]
    verbs: ["get","list","watch"]
  - apiGroups: [""]
    resources: ["pods/exec"]
    verbs: ["create"]
  - apiGroups: ["apps"]
    resources: ["replicasets/status", "daemonsets/status", "deployments/status", "statefulsets/status"]
    verbs: ["get"]
  - apiGroups: ["batch"]
    resources: ["jobs/status", "cronjobs/status"]
    verbs: ["get"]
---
# Source: qualys-tc/charts/runtimeSensor/templates/runtime-sensor-clusterrole.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name:  qualys-runtime-sensor-cluster-role
rules:
  - apiGroups: ["apiextensions.k8s.io"]
    verbs: ["get","list","watch"]
    resources: ["customresourcedefinitions"]
  - apiGroups: [""]
    resources: ["pods","services","nodes","namespaces"]
    verbs: ["get","list","watch"]
  - apiGroups: ["cilium.io"]
    resources: ["tracingpolicies","tracingpoliciesnamespaced"]
    verbs: ["get","list","watch"]
  - apiGroups: ["qualys.com"]
    resources: ["policies"]
    verbs: ["get","list","watch"]
---
# Source: qualys-tc/charts/admissionController/templates/cluster-role-binding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: admission-controller
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: admission-controller
subjects:
  - kind: ServiceAccount
    name: admission-controller-qualys-sa
    namespace: qualys
---
# Source: qualys-tc/charts/clusterSensor/templates/clustersensor-clusterrolebinding.yaml
kind: ClusterRoleBinding
# if k8s version is 1.17 and earlier then change apiVersion to "rbac.authorization.k8s.io/v1beta1"
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: qualys-clustersensor-cluster-reader-rb
subjects:
- kind: ServiceAccount
  name: qualys-clustersensor-sa
  namespace: qualys
roleRef:
  kind: ClusterRole
  name: qualys-clustersensor-cluster-reader-role 
  apiGroup: rbac.authorization.k8s.io
---
# Source: qualys-tc/charts/qcsSensor/templates/cssensor-clusterrolebinding.yaml
# ClusterRoleBinding to assign permissions in qualys-cluster-reader-role to qualys-service-account
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: qualys-cluster-reader-rb
subjects:
  - kind: ServiceAccount
    name: qualys-service-account
    namespace: qualys
roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: qualys-cluster-reader-role
---
# Source: qualys-tc/charts/runtimeSensor/templates/runtime-sensor-clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: qualys-runtime-sensor
subjects:
  - kind: ServiceAccount
    name: qualys-runtimesensor-sa
    namespace: qualys
roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: qualys-runtime-sensor-cluster-role
---
# Source: qualys-tc/charts/qcsSensor/templates/cssensor-role.yaml
# Role for all permission to qualys namespace
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: qualys-reader-role
  namespace: qualys
rules:
  - apiGroups: [""]
    resources: ["pods"]
    verbs: ["create", "delete", "deletecollection"]
  - apiGroups: ["batch"]
    resources: ["jobs"]
    verbs: ["get","create", "delete", "deletecollection"]
  - apiGroups: [""]
    resources: ["pods/attach"]
    verbs: ["create"]
---
# Source: qualys-tc/charts/qcsSensor/templates/cssensor-rolebinding.yaml
# RoleBinding to assign permissions in qualys-reader-role to qualys-service-account
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: qualys-reader-rb
  namespace: qualys
subjects:
  - kind: ServiceAccount
    name: qualys-service-account
    namespace: qualys
roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: Role
    name: qualys-reader-role
---
# Source: qualys-tc/charts/admissionController/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: admission-controller
  namespace: qualys
spec:
  ports:
    - port: 443
      targetPort: 8443
  selector:
    app: admission-controller
---
# Source: qualys-tc/charts/qcsSensor/templates/cssensor-daemonset.yaml
# Qualys Container Sensor DaemonSet pod

apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: qualys-container-sensor
  namespace: qualys
  labels:
    k8s-app: qualys-cs-sensor
spec:
  selector:
    matchLabels:
      name: qualys-container-sensor
  updateStrategy:
      type: RollingUpdate
  template:
    metadata:
      labels:
        name: qualys-container-sensor
    spec:
      serviceAccountName: qualys-service-account
      containers:
      - name: qualys-container-sensor
        image: qualys/qcs-sensor:1.36.1-0
        imagePullPolicy: IfNotPresent
        resources:
          limits:
            cpu: 0.5 # Default CPU usage limit on each node for sensor.
        args:
        - "--k8s-mode"
        - "--container-runtime"
        - "cri-o"
        - "--sensor-without-persistent-storage"
        - "--enable-console-logs"
        - "--optimize-image-scans"
        - "--scan-thread-pool-size"
        - "2"
        - "--log-filepurgecount"
        - "5"
        - "--log-filesize"
        - "10M"
        - "--log-level"
        - "3"
        - "--scanning-policy"
        - StaticScanningOnly
        - "--perform-sca-scan"
        - "--sca-scan-timeout-in-seconds"
        - "900"
        env:
        - name: CUSTOMERID
          value: "dc965ac5-375a-dd6a-834d-788f666fad44"
        - name: ACTIVATIONID
          value: "f70e5b6a-0cb3-4a24-9994-843c5d40f028"
        - name: POD_URL
          value: "https://cmsqagpublic.qg1.apps.qualys.co.uk/ContainerSensor"
        - name: QUALYS_SCANNING_CONTAINER_LAUNCH_TIMEOUT
          value: "10"
        - name: QUALYS_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: QUALYS_POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        volumeMounts:
        - mountPath: "/var/run/crio/crio.sock"
          name: socket-volume
          readOnly: true
        - mountPath: /usr/local/qualys/qpa/data/conf/agent-data
          name: agent-volume
        - mountPath: /var/lib/containers/storage
          name: container-storage
        securityContext:
          privileged: true
      volumes:
        - name: socket-volume
          hostPath:
            path: /var/run/crio/crio.sock
            type: Socket
        - name: agent-volume
          hostPath:
            path: /etc/qualys
            type: DirectoryOrCreate
        - name: container-storage
          hostPath:
            path: /var/lib/containers/storage
      hostNetwork: true
---
# Source: qualys-tc/charts/runtimeSensor/templates/runtime-sensor-daemonset.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: qualys-runtime-sensor
  namespace: qualys
  labels:
    k8s-app: qualys-runtime-sensor
spec:
  selector:
    matchLabels:
      name: qualys-runtime-sensor
  template:
    metadata:
      labels:
        name: qualys-runtime-sensor
    spec:
      serviceAccountName: qualys-runtimesensor-sa
      hostNetwork: true
      containers:
      - name: qualys-runtime-sensor
        image: qualys/runtime-sensor:1.1.0-0
        imagePullPolicy: Always
        resources:
          requests:
            memory: 250Mi
            cpu: 50m
          limits:
            memory: 1024Mi
            cpu: 100m
        args:
        - "--customer-id"
        - "dc965ac5-375a-dd6a-834d-788f666fad44"
        - "--activation-id"
        - "f70e5b6a-0cb3-4a24-9994-843c5d40f028"
        - "--gateway-url"
        - "https://gateway.qg1.apps.qualys.co.uk"
        - "--log-level"
        - "info"
        - "--log-file-size"
        - "10"
        - "--log-file-purge-count"
        - "5"
        - "--cloud-provider"
        - "SELF_MANAGED_K8S"
        - "--cluster-name"
        - "virttest"
        env:
        - name: "QUALYS_IGNORE_PROCESS_LIST"
          value: 
        - name: NODE_NAME
          valueFrom:
            fieldRef:
               fieldPath: spec.nodeName
        - name: QUALYS_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name   
        - name: QUALYS_POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace 
        securityContext:
          privileged: true
        volumeMounts:
        - mountPath: /usr/local/qualys/runtime-sensor/data
          name: persistent-volume
      volumes:
      - name: persistent-volume
        hostPath:
           path: /usr/local/qualys/runtime-sensor/data
           type: DirectoryOrCreate
---
# Source: qualys-tc/charts/admissionController/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: admission-controller
    cs.qualys.com/webhook: ignore
  name: admission-controller
  namespace: qualys
spec:
  replicas: 1
  selector:
    matchLabels:
      app: admission-controller
  strategy:
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: admission-controller
      annotations:
        rollme/uponProxyUpdate: c6f6a9d62f6f2eef341759d378b3feaba3d032b7b1c98744dae0f5416b10c97b
        rollme/uponApiConfigUpdate: be5b272c092eaabf0acf0325f008c6fd767d16241d50c7a397546139ecdfab6f
        rollme/uponWebhookUpdate: c6e524d5da386d6b18a7607816fb35dad4a934f5cf1ab169c51d7cf97b9b3017
        checksum/config: 021347c69c72ed1f6286f8283afeb2e5274f89fe93c8da042c272e7e5efb4bf1
    spec:
      serviceAccountName: admission-controller-qualys-sa
      containers:
        - name: admission-controller
          ports:
            - containerPort: 8443
              name: adm-ctrl-port
          env:
            - name: CONFIG_PATH
              value: "/etc/config/config.yaml"
            - name: REGISTRY_CONFIG_PATH
              value: "/etc/config/registry-config.yaml"
          livenessProbe:
            initialDelaySeconds: 5
            periodSeconds: 5
            httpGet:
              scheme: HTTPS
              path: /healthz
              port: 8443
          volumeMounts:
            - name: "certs"
              mountPath: "/etc/certs"
              readOnly: true
            - name: "admission-controller-volume"
              mountPath: "/etc/config/config.yaml"
              subPath: "config.yaml"
              readOnly: true
            - name: "qualys-registry-config-volume"
              mountPath: "/etc/config/registry-config.yaml"
              subPath: "registry-config.yaml"
              readOnly: true
          image: "qualys/admission-controller:1.1.0-17"
          imagePullPolicy: Always
          resources:
            limits:
              cpu: 200m # Default CPU usage limit.
              memory: 256Mi
            requests:
              cpu: 100m
              memory: 256Mi
      volumes:
        - name: "certs"
          secret:
            secretName: admission-controller-certs
        - name: "admission-controller-volume"
          configMap:
            name: admission-controller-config
            items:
              - key: "config.yaml"
                path: "config.yaml"
        - name: "qualys-registry-config-volume"
          configMap:
            name: qualys-registry-config
            items:
              - key: "registry-config.yaml"
                path: "registry-config.yaml"
---
# Source: qualys-tc/charts/clusterSensor/templates/clustersensor-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: qualys-cluster-sensor
  namespace: qualys
  labels:
    k8s-app: qualys-cluster-sensor
spec:
  replicas: 1
  selector:
    matchLabels:
      name: qualys-cluster-sensor
  template:
    metadata:
      labels:
        name: qualys-cluster-sensor
    spec:
      serviceAccountName: qualys-clustersensor-sa
      securityContext:
        fsGroup: 555
      containers:
      - name: qualys-cluster-sensor
        image:  qualys/cluster-sensor:1.1.2-0
        imagePullPolicy : Always
        securityContext:
          runAsUser: 555
          runAsGroup: 555
          runAsNonRoot: true
          allowPrivilegeEscalation: false
        resources:
          limits:
            cpu: 200m
            memory: 256Mi
          requests:
            cpu: 100m
            memory: 256Mi
        args:
        - "--customer-id"
        - "dc965ac5-375a-dd6a-834d-788f666fad44"
        - "--activation-id"
        - "f70e5b6a-0cb3-4a24-9994-843c5d40f028"
        - "--gateway-url"
        - "https://gateway.qg1.apps.qualys.co.uk"
        - "--cloud-provider"
        - "SELF_MANAGED_K8S"
        - "--cluster-name"
        - "virttest"
        env:
        - name: CLUSTERSENSOR_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: CLUSTERSENSOR_POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        volumeMounts:
      volumes:
      hostNetwork: true
---
# Source: qualys-tc/charts/qcsSensor/templates/cssensor-persistentvolumeclaim.yaml
# PersistentVolumeClaim
---
# Source: qualys-tc/charts/qcsSensor/templates/cssensor-priorityclass.yaml
# PriorityClass
---
# Source: qualys-tc/charts/qcsSensor/templates/cssensor-secret.yaml
# Secret
---
# Source: qualys-tc/charts/clusterSensor/templates/clustersensor-securitycontextconstraints.yaml
# OpenShift
kind: SecurityContextConstraints
apiVersion: security.openshift.io/v1
metadata:
  name: scc-qualys-cluster-sensor
allowHostDirVolumePlugin: true
allowHostNetwork: true
allowHostIPC: false
allowHostPID: false
allowHostPorts: false
allowPrivilegedContainer: false
readOnlyRootFilesystem: false
runAsUser:
  type: RunAsAny
seLinuxContext:
  type: RunAsAny
users:
- system:serviceaccount:qualys:qualys-clustersensor-sa
---
# Source: qualys-tc/charts/qcsSensor/templates/cssensor-securitycontextconstraints.yaml
# OpenShift
kind: SecurityContextConstraints
apiVersion: security.openshift.io/v1
metadata:
  name: scc-qualys-sensor
allowHostDirVolumePlugin: true
allowHostNetwork: true
allowHostIPC: false
allowHostPID: false
allowHostPorts: false
allowPrivilegedContainer: true
readOnlyRootFilesystem: false
runAsUser:
  type: RunAsAny
seLinuxContext:
  type: RunAsAny
users:
- system:serviceaccount:qualys:qualys-service-account
---
# Source: qualys-tc/charts/runtimeSensor/templates/runtime-sensor-securitycontextconstraints.yaml
# OpenShift
kind: SecurityContextConstraints
apiVersion: security.openshift.io/v1
metadata:
  name: scc-qualys-runtimesensor-sa
allowHostDirVolumePlugin: true
allowHostNetwork: true
allowHostIPC: false
allowHostPID: false
allowHostPorts: false
allowPrivilegedContainer: true
readOnlyRootFilesystem: false
runAsUser:
  type: RunAsAny
seLinuxContext:
  type: RunAsAny
users:
- system:serviceaccount:qualys:qualys-runtimesensor-sa
---
# Source: qualys-tc/charts/admissionController/templates/validating-webhook-configuration.yaml
apiVersion: v1
kind: Secret
metadata:
  name: admission-controller-certs
  annotations:
    # Using helm hook to create certs only for chart install
    "helm.sh/hook": "pre-install, pre-upgrade"
    "helm.sh/hook-delete-policy": "before-hook-creation"
type: kubernetes.io/tls
data:
  ca.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURMekNDQWhlZ0F3SUJBZ0lRWFdnOG91TkJVRHdaZ244SXBSNTFNVEFOQmdrcWhraUc5dzBCQVFzRkFEQWkKTVNBd0hnWURWUVFERXhkaFpHMXBjM05wYjI0dFkyOXVkSEp2Ykd4bGNpMWpZVEFlRncweU5UQTNNVGd3T0RRdwpNVEZhRncwek5UQTNNVFl3T0RRd01URmFNQ0l4SURBZUJnTlZCQU1URjJGa2JXbHpjMmx2YmkxamIyNTBjbTlzCmJHVnlMV05oTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFwNWdIb3BtcUZjczYKdzRQVjVVaWVDVllHYjdLUjhadUw5QzdjT2lyRVFBQWpmeFcyNUJzZzhYc09ybHpGVVpQNFpwWjdWUEFBdWtNZwo5cmFpbnNPUTd5QXo5MlN1SVZKQ29XT3NwOHdJNmRveUtEQ1ZRQWs0NDBaeUFKUnlzakJnN2hkVmd2Wi9sNjVzCnNyZFllMlBsNlpZbjhVWlNkSzJmRTZEN0E3NDBlZ2V6S1FGNVJGSG42WC81cmlNUk5lM2E0K09SVFRrc1lBZXEKWmF5RXZKMTFsWnNZWnRBMEhZWGdEUVIxWmZzWk1zTnJRT1VUWkhKN3FtYnp3TUZGd3drZmZRdWkrcEVPYk1lagpnamVIamRQcE12dTZQNXRvZTliMzh1bFV5VFh3WlNpcnRPYUVWNkJyc1RvUmtXNmhnMURraXpub1UxSjRaNkc3CjRZMVFyczJqTlFJREFRQUJvMkV3WHpBT0JnTlZIUThCQWY4RUJBTUNBcVF3SFFZRFZSMGxCQll3RkFZSUt3WUIKQlFVSEF3RUdDQ3NHQVFVRkJ3TUNNQThHQTFVZEV3RUIvd1FGTUFNQkFmOHdIUVlEVlIwT0JCWUVGRmZIckxwLwpNQW9Ldm4xcEhQZ0NKd293akRLZk1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQUJjYUs5MVdUYUpicW1uMDFXCmFWQlo4cFBycVFIVy9iendGdlF0YlBJSmxzdEJjY2RpWWNha281dld6TTFDa0d4SitqUkZrUDNROE5CUGtLb0QKbnV2OUh3Z0xtS2xKRjFpd1BGUEFteWg4ZTI1L3hmT29ac0ZMa0c3NmhPMTdGdjkyQW41M0JHN1NrQmpnM1N2Nwp0K1dRUHNVeG5URFMyYmNwWUFFQWJTb2ZMaDhHZWQvc0JWTnB3SnplNXVBNFRzRmtvN1R6ald4SWFwV1dsUFpoCmg5NTBtbjh2QXNDekdXaDJoTnF5VVVyRUlGbTRJc0VUQW5QZkhJNDdud0JEblJwTEx6NG5MMU02MVRYS2huZFAKTFczV2JGbmlkczJtdjB4VDhwMGM3TXB3ZVEvVW9HaFZIWDY5RHJ5VTlwREFWalNTNE9DYVRDYWZBZmcwTnROUwpaVUhFCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURwVENDQW8yZ0F3SUJBZ0lRWVV6UkthT0Q3OFhPTmFtRzVkRUUzekFOQmdrcWhraUc5dzBCQVFzRkFEQWkKTVNBd0hnWURWUVFERXhkaFpHMXBjM05wYjI0dFkyOXVkSEp2Ykd4bGNpMWpZVEFlRncweU5UQTNNVGd3T0RRdwpNVEZhRncwek5UQTNNVFl3T0RRd01URmFNQjh4SFRBYkJnTlZCQU1URkdGa2JXbHpjMmx2YmkxamIyNTBjbTlzCmJHVnlNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQW9adktCRzZXRDlTRVFoeDMKWlU1QkRXZUZ3SUFiMmxrS1Q3VDRqYmRGUmhhUXk0WUpYdldJRUZDNm9pRFRDaVU0U25NRHFHMXl4cmZEcGJMNgp5dUNwVms5Y2RlTk1YQVdiNDZFUlBPcjlmd0R2OWp0K25qSkkvUXg1RGxydnlhR3hBSWhCWjlMNFhnVTg2N0RxCklvWDJGVUVwTWlQRCtiWHcyYjFuR1ZGSWlnNjk0TlRHVTBrWWJCN00ybWQ3WGZ2MUxwKzVLSitzVDI0dHEwL0oKR0M2NEp2YlNvRFVPQUMvbUN0TFFoeW5Kcm45Wjl1bWt3ZVgxbDZWMjBMN3pIY1hlbFNRNnZlN2JVcWVxcEZhbgpiNStTaEg1WEg1dStZRDdBOG1HcmgxcFh4UWFnRlFRTzh4bFM0U29XQ3NJWWZFN2dNWWlhK2V0ZmJYdE1VeWZUCmFsYmtLUUlEQVFBQm80SFpNSUhXTUE0R0ExVWREd0VCL3dRRUF3SUZvREFkQmdOVkhTVUVGakFVQmdnckJnRUYKQlFjREFRWUlLd1lCQlFVSEF3SXdEQVlEVlIwVEFRSC9CQUl3QURBZkJnTlZIU01FR0RBV2dCUlh4Nnk2ZnpBSwpDcjU5YVJ6NEFpY0tNSXd5bnpCMkJnTlZIUkVFYnpCdGdodGhaRzFwYzNOcGIyNHRZMjl1ZEhKdmJHeGxjaTV4CmRXRnNlWE9DSDJGa2JXbHpjMmx2YmkxamIyNTBjbTlzYkdWeUxuRjFZV3g1Y3k1emRtT0NMV0ZrYldsemMybHYKYmkxamIyNTBjbTlzYkdWeUxuRjFZV3g1Y3k1emRtTXVZMngxYzNSbGNpNXNiMk5oYkRBTkJna3Foa2lHOXcwQgpBUXNGQUFPQ0FRRUFLcmppMENQaXFXd01pMUhlSmIyY3c4dVZ1MFJIVHhaSnZrektpWFFWaGxPcENXSE04dTVmCjE1WXFLa1ZQcUdHOGVoMkR0ODVhdTFQbDM1MktJTGpvVmdGMGUwQ0Rlai9ITEJXeFkvQzZwbDZVRHRYQm9VQkMKNUw5OFFEeGRHbGxFTThHcHJ1ZGNzMTFqdjdZNEtxMXBlK3ZuWlVlNmYydERDMWZQNmJoNVJ6NTA1YkpnbjcwUgpqYmRQTUdjbkx0OC9pdm9wU25YQ3FvbDVna1Z2bWRiUnNiSDZ4ZWYzcGpIeDY1dHZwOEpSczlpQjVrTjlhek9ZCmtwKzFrOEhXMUlMbVpoU0hVNjI0NHI5Z3JnZ21JU1E1ZjF3NTliaDh3cUNML3pOS1NNdytJaDNXbzlHNHovNUMKVzUralBWa3JXTTlBWCtHTUEwYUl6MDhwTWhMWG9od1NRdz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBb1p2S0JHNldEOVNFUWh4M1pVNUJEV2VGd0lBYjJsa0tUN1Q0amJkRlJoYVF5NFlKClh2V0lFRkM2b2lEVENpVTRTbk1EcUcxeXhyZkRwYkw2eXVDcFZrOWNkZU5NWEFXYjQ2RVJQT3I5ZndEdjlqdCsKbmpKSS9ReDVEbHJ2eWFHeEFJaEJaOUw0WGdVODY3RHFJb1gyRlVFcE1pUEQrYlh3MmIxbkdWRklpZzY5NE5URwpVMGtZYkI3TTJtZDdYZnYxTHArNUtKK3NUMjR0cTAvSkdDNjRKdmJTb0RVT0FDL21DdExRaHluSnJuOVo5dW1rCndlWDFsNlYyMEw3ekhjWGVsU1E2dmU3YlVxZXFwRmFuYjUrU2hINVhINXUrWUQ3QThtR3JoMXBYeFFhZ0ZRUU8KOHhsUzRTb1dDc0lZZkU3Z01ZaWErZXRmYlh0TVV5ZlRhbGJrS1FJREFRQUJBb0lCQUhkR0ZMNWFvL1JCQS9BTApORytYWnRtdXl2OTlUWkZFWUNEZHp3aEErQ2EzWnR4Zks3RmpBNjRPOXYvTHZCWmp5L3pla0JlUjE4RWtSWWlZCjVSSXc1Nm5rM3JlL0wwOUhjSHQ3Rjg3ZkhJTE12VTM5TVFFdTJjR3huL0xoV05KMnZMMUkwd1QrcHdJMVdYWVcKVjJkdGVXYk1kY3drcTNJMFB2TmxINStHNTBQRVd3QUZkYnVNSm5LcDZsUXhCdE5oMlZiYitqc0M2K01iOEU1Rwo1VzJoWHhaUEtqbWljdDVjQ0NVeWVXY2t0NTRvZmJMem5PeCt0RE5YcnIra1dEMnZBOURpakkxSTByd0VPMmU4CnJtQXpVbkR6UVg3SDBYZi9janFWajE3TXlwb3RPWUxjMm1NTVM0L1hCeXlyZDV6TFE1MkE2Z0dYLzVTYU9kYkgKRXhHeDBNVUNnWUVBMU9PdU9nMDROR3NhWFdUemFHZUJGQ0FCZGJjOTRuNDhWRmo0dGhmZmxSRDk4VDFERlZQYgo3QlNMOGpTbXhMQlpvcG9IdHRCdHpBck0xcDhmYzNzbVA1UTBJT01NOGxyc3RKZ0ttMjZFYkV3RnFBZVhHNWlZCjdhc0FFa2ZNM0wvN1ZOUW80b1RkQzVaVUZ4VVZmUEdFbmkxY210SUk3dERtZVdSUktyQU9YbnNDZ1lFQXdsV3QKb004aXMwNnNwWFF0RHFoZ3pjR2hOS2ZDQVArRnJVdllVU0Q0bXBHcVVFUzhpM1NESndNR0JtcUhlTTFEalRuSgpES1V5ODdVMVlscFVDcnlHUFg5dUllbEsxNGpaZktQamVXU3pDaUF6Y1hYMG8rRzRRNEVDT2JLOXJ3LzlmMmdZCkNhUi9VbzlGb2phQzFNdnV2NTRJRmxtNFZnSHowYjlWQ2FjeTJLc0NnWUVBd0JJTEJ1VVdhSFNZL05vdm9XcUEKMHA5dHNiNzVYbmQyQnNPZTRPcjVGWXlYRUNldGRuaUtXcHpQQmw3cWQxcUVCR2ZqdmRTZXV4Q2picDl4eU1hNgo0M0hhOWpEalpXVVRXbnd5VmJtSVVBem1yWXJya2tKQzkycm9UWlhxQnVCTzZXSGc0VDN1RUo0NGovcTl3RlJHCnlrOHkxWnZaNDEwbUV5K202MVNjSWpFQ2dZQmYxeU5mR0dpVHA2eExtT1VUd29TalZPZ3M4TU1qL09Ddlc2VmUKTlhXRnZXc1NWU1ByWHRYRHFxRVJEdjZxM0FpQm9Nci9lb1dMWFlYcmNJTGNIS2ZUc29IZEpaSHNoQ2hHYVFrcAplRGs0T0ROR3RKYW5NQTNROU5IbEpMcVptTGc3V2xub2Y0RHZkWXN3K2ROQ0lTVW95VVpSeDRPNm54SGhFb3hjCnkyR3ZLd0tCZ1FDdlYyb0h1TXExTjVBUm1FTUxlSTFzY1pKQmJBdnNSVGljanNSZUh0SW9QL0pXaGZTM2cxQk8KS1hSenMzdnJQdGlGbFpCWUNPYUpGdmRnYUFoeTZTSEY3SWVRQWwxT1hjd3YzU2VQQjd0SEdJNUMyeWg0RTQvMApIdW9kQVBTcjVJVElsTnAwUEIrYkxVdWFPUXNsQlF5QmhKWTBBVlc2ZGtHMVZLcndsSGh0emc9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
---
# Source: qualys-tc/charts/admissionController/templates/validating-webhook-configuration.yaml
apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
metadata:
  name: admission-controller
  namespace: "qualys"
  annotations:
    "helm.sh/hook": "post-install, post-upgrade"
    "helm.sh/hook-delete-policy": "before-hook-creation"
webhooks:
  - name: cs.qualys.com
    failurePolicy: Ignore
    namespaceSelector:
      matchExpressions:
        - key: cs.qualys.com/webhook
          operator: NotIn
          values:
          - ignore
        - key: kubernetes.io/metadata.name
          operator: NotIn
          values:
          - qualys
    rules:
      - apiGroups: ["apps", "", "v1", "batch"]
        apiVersions: ["*"]
        operations:  ["CREATE", "UPDATE"]
        resources:   ["pods"]
    clientConfig:
      service:
        namespace: qualys
        name: admission-controller
        path: "/validate"
      caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURMekNDQWhlZ0F3SUJBZ0lRWFdnOG91TkJVRHdaZ244SXBSNTFNVEFOQmdrcWhraUc5dzBCQVFzRkFEQWkKTVNBd0hnWURWUVFERXhkaFpHMXBjM05wYjI0dFkyOXVkSEp2Ykd4bGNpMWpZVEFlRncweU5UQTNNVGd3T0RRdwpNVEZhRncwek5UQTNNVFl3T0RRd01URmFNQ0l4SURBZUJnTlZCQU1URjJGa2JXbHpjMmx2YmkxamIyNTBjbTlzCmJHVnlMV05oTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFwNWdIb3BtcUZjczYKdzRQVjVVaWVDVllHYjdLUjhadUw5QzdjT2lyRVFBQWpmeFcyNUJzZzhYc09ybHpGVVpQNFpwWjdWUEFBdWtNZwo5cmFpbnNPUTd5QXo5MlN1SVZKQ29XT3NwOHdJNmRveUtEQ1ZRQWs0NDBaeUFKUnlzakJnN2hkVmd2Wi9sNjVzCnNyZFllMlBsNlpZbjhVWlNkSzJmRTZEN0E3NDBlZ2V6S1FGNVJGSG42WC81cmlNUk5lM2E0K09SVFRrc1lBZXEKWmF5RXZKMTFsWnNZWnRBMEhZWGdEUVIxWmZzWk1zTnJRT1VUWkhKN3FtYnp3TUZGd3drZmZRdWkrcEVPYk1lagpnamVIamRQcE12dTZQNXRvZTliMzh1bFV5VFh3WlNpcnRPYUVWNkJyc1RvUmtXNmhnMURraXpub1UxSjRaNkc3CjRZMVFyczJqTlFJREFRQUJvMkV3WHpBT0JnTlZIUThCQWY4RUJBTUNBcVF3SFFZRFZSMGxCQll3RkFZSUt3WUIKQlFVSEF3RUdDQ3NHQVFVRkJ3TUNNQThHQTFVZEV3RUIvd1FGTUFNQkFmOHdIUVlEVlIwT0JCWUVGRmZIckxwLwpNQW9Ldm4xcEhQZ0NKd293akRLZk1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQUJjYUs5MVdUYUpicW1uMDFXCmFWQlo4cFBycVFIVy9iendGdlF0YlBJSmxzdEJjY2RpWWNha281dld6TTFDa0d4SitqUkZrUDNROE5CUGtLb0QKbnV2OUh3Z0xtS2xKRjFpd1BGUEFteWg4ZTI1L3hmT29ac0ZMa0c3NmhPMTdGdjkyQW41M0JHN1NrQmpnM1N2Nwp0K1dRUHNVeG5URFMyYmNwWUFFQWJTb2ZMaDhHZWQvc0JWTnB3SnplNXVBNFRzRmtvN1R6ald4SWFwV1dsUFpoCmg5NTBtbjh2QXNDekdXaDJoTnF5VVVyRUlGbTRJc0VUQW5QZkhJNDdud0JEblJwTEx6NG5MMU02MVRYS2huZFAKTFczV2JGbmlkczJtdjB4VDhwMGM3TXB3ZVEvVW9HaFZIWDY5RHJ5VTlwREFWalNTNE9DYVRDYWZBZmcwTnROUwpaVUhFCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
    admissionReviewVersions: ["v1", "v1beta1"]
    sideEffects: None
    timeoutSeconds: 30
